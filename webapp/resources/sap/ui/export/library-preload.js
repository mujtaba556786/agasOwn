//@ui5-bundle sap/ui/export/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportBase", ["sap/ui/core/Core","sap/ui/base/EventProvider","sap/base/Log","sap/ui/export/ExportUtils"],function(t,e,r,o){"use strict";var n=e.extend("sap.ui.export.ExportBase",{constructor:function(t){e.call(this,t);this._mSettings={fileName:"Export"};["count","dataSource","fileName","fileType","workbook"].forEach(function(e){if(typeof t[e]!=="undefined"){this._mSettings[e]=e!=="dataSource"?t[e]:this.processDataSource(t[e])}}.bind(this))}});n.prototype.attachBeforeExport=function(t,e,r){return this.attachEvent("beforeExport",t,e,r)};n.prototype.detachBeforeExport=function(t,e){return this.detachEvent("beforeExport",t,e)};n.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this.cancel();this.bIsDestroyed=true};n.prototype.cancel=function(){throw new Error("Abstract function not implemented")};n.prototype.processDataSource=function(t){throw new Error("Abstract function not implemented")};n.prototype.setDefaultExportSettings=function(t){throw new Error("Abstract function not implemented")};n.prototype.createBuildPromise=function(t){throw new Error("Abstract function not implemented")};n.prototype.getMimeType=function(){throw new Error("Abstract function not implemented")};n.prototype.build=function(){var t=this._mSettings;if(this.bIsDestroyed){var e=this.getMetadata().getName()+": Cannot trigger build - the object has been destroyed";r.error(e);return Promise.reject(e)}return this.setDefaultExportSettings(t).then(function(){this.fireEvent("beforeExport",{exportSettings:t},false,false);o.validateSettings(t);return this.createBuildPromise(t)}.bind(this))};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportDialog", ["sap/ui/core/library","sap/m/library","sap/m/Dialog","sap/m/Button","sap/m/ProgressIndicator","sap/m/Text","sap/m/MessageBox","sap/ui/core/format/NumberFormat"],function(e,t,n,a,s,i,r,o){"use strict";var u=e.ValueState;var f=t.DialogType;var g=t.ButtonType;var l=sap.ui.getCore().getLibraryResourceBundle("sap.ui.export",true);function T(){return new Promise(function(e,t){var r;l.then(function(t){var o=new a({text:t.getText("CANCEL_BUTTON"),press:function(){if(r&&r.oncancel){r.oncancel()}r.finish()}});var g=new s({displayAnimation:false,displayValue:"0 / 0",showValue:true,height:"0.75rem",state:u.Information});g.addStyleClass("sapUiMediumMarginTop");var l=new i({text:t.getText("PROGRESS_FETCHING_MSG")});r=new n({title:t.getText("PROGRESS_TITLE"),type:f.Message,contentWidth:"500px",content:[l,g],endButton:o,ariaLabelledBy:[l]});r.updateStatus=function(e,n,a){var s;if(typeof e==="string"&&e){a=e;l.setText(a)}if(!isNaN(e)&!isNaN(n)){s=e/n*100}if(s>=100){g.setState(u.Success);o.setEnabled(false);l.setText(a||t.getText("PROGRESS_BUNDLE_MSG"))}g.setPercentValue(s);if(isNaN(n)||n<=0||n>=1048575){n="âˆž"}if(!isNaN(e)){g.setDisplayValue(""+e+" / "+n)}};r.finish=function(){r.close();r.destroy()};e(r)})})}function c(e){return new Promise(function(t,s){l.then(function(r){var l,T,c,p,R,x;R=o.getIntegerInstance({groupingEnabled:true});l=false;p="";if(!e.rows){p=r.getText("NO_COUNT_WARNING_MSG")}else{x=R.format(e.rows);if(e.sizeLimit){p=r.getText("SIZE_WARNING_MSG",[x,e.columns])}if(e.cutOff){p+=p===""?"":"\n\n";p+=r.getText("MSG_WARNING_CUT_OFF",[x])}}c=new i({text:p});T=new n({title:r.getText("PROGRESS_TITLE"),type:f.Message,state:u.Warning,content:c,ariaLabelledBy:c,endButton:new a({type:g.Transparent,text:r.getText("CANCEL_BUTTON"),press:function(){T.close()}}),beginButton:new a({type:g.Emphasized,text:r.getText("EXPORT_BUTTON"),press:function(){l=true;T.close()}}),afterClose:function(){T.destroy();l?t():s()}});T.open()})})}function p(e){if(!e){return}if(e instanceof Error){e=e.message}l.then(function(t){var n=e||t.getText("PROGRESS_ERROR_DEFAULT");if(e.toLowerCase().indexOf("invalid string length")>-1){n=t.getText("MSG_ERROR_OUT_OF_MEMORY")}r.error(n,{title:t.getText("PROGRESS_ERROR_TITLE")})})}return{getProgressDialog:T,showErrorMessage:p,showWarningDialog:c}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportHandler", ["./library","./ExportUtils","./ExportDialog","sap/m/MessageToast","sap/ui/core/Core","sap/ui/base/EventProvider","sap/ui/model/odata/v4/ODataModel","sap/ui/util/openWindow"],function(e,t,i,r,n,o,a,l){"use strict";var s=e.Destination;var h=e.FileType;var u=o.extend("sap.ui.export.ExportHandler",{constructor:function(e){var t=this;o.call(this);this._mCapabilities=e instanceof Object?e:{XLSX:{}};this._initialized=new Promise(function(e){t.isGoogleSheetSupported().then(function(e){if(e){t._mCapabilities[h.GSHEET]={};t._mDialogSettings={destination:s.REMOTE,fileType:h.GSHEET}}}).finally(e)})}});u.prototype.attachBeforeExport=function(e,t,i){return this.attachEvent("beforeExport",e,t,i)};u.prototype.detachBeforeExport=function(e,t){return this.detachEvent("beforeExport",e,t)};u.prototype.initialized=function(){return this._initialized};u.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments);if(this._oModel){this._oModel.destroy()}if(this._oFileShareBinding){this._oFileShareBinding.destroy()}if(this._oExportDialog){this._oExportDialog.destroy()}if(this._oFilePicker){this._oFilePicker.destroy()}this._mCapabilities=null;this._oDataSource=null;this._mDialogSettings=null;this._oModel=null;this._oFileShareBinding=null;this.bIsDestroyed=true};u.prototype.getFileShareContexts=function(){return this.getFileShareModel().then(function(e){if(!e){return Promise.resolve([])}if(!this._oFileShareBinding){this._oFileShareBinding=e.bindList("/FileShares")}return this._oFileShareBinding.requestContexts(0)}.bind(this))};u.prototype.getRemoteFileLocation=function(e){var i=this;return new Promise(function(r,n){Promise.all([t.getResourceBundle(),i.getFileShareModel()]).then(function(t){var o=t[0];var a=t[1];sap.ui.require(["sap/suite/ui/commons/CloudFilePicker"],function(t){var l;i._oFilePicker=l=new t({sharedModel:a,suggestedFileName:e,enableDuplicateCheck:true,fileNameMandatory:true,confirmButtonText:o.getText("EXPORT_BUTTON"),title:o.getText("DESTINATION_DIALOG_TITLE")});l.attachSelect(function(e){var t,i,a,l={};t=e.getParameter("selectedFiles");i=e.getParameter("selectedFolder");a=e.getParameter("replaceExistingFile");l={};l["FileShare"]=i.getFileShareId();l["FileShareItemKind"]="document";l["FileShareItemName"]=e.getParameter("selectedFileName");l["ParentFileShareItem"]=i.getFileShareItemId();if(a&&Array.isArray(t)&&t.length>0){var s=t.shift();l["FileShareItem"]=s.getFileShareItemId()}if(!l["FileShare"]){n(o.getText("DESTINATION_SELECTION_INCOMPLETE"))}r(l)});l.open()})})})};u.prototype.getExportInstance=function(e,n,o){var a=this;return Promise.all([t.getResourceBundle(),t.getExportInstance(e)]).then(function(t){var l=t[0];var s=t[1];s.attachBeforeExport(function(e){var t=e.getParameter("exportSettings");a.fireEvent("beforeExport",{exportSettings:t,userExportSettings:n||{}},false,false)});if(o&&typeof s.attachBeforeSave==="function"){s.attachBeforeSave(function(t){var n,u;n=t.getParameter("data");u=t.getParameter("exportDialog");o["FileShareItemContentType"]=s.getMimeType();o["FileShareItemConvertToMimeType"]=s.getMimeType();if(e.fileType===h.GSHEET){o["FileShareItemConvertToMimeType"]="application/vnd.google-apps.spreadsheet"}var c=new Uint8Array(n);var f=new Array(c.length);for(var p=0;p<c.length;p++){f[p]=String.fromCharCode(c[p])}o["FileShareItemContent"]=btoa(f.join(""));u.updateStatus(l.getText("DESTINATION_DIALOG_STATUS"));t.preventDefault();a.uploadFile(o).then(function(){r.show(l.getText("DESTINATION_TRANSFER_SUCCESS"))}).catch(function(){i.showErrorMessage(l.getText("DESTINATION_TRANSFER_ERROR"))}).finally(function(){u.finish()})})}return s})};u.prototype.uploadFile=function(e){return this.getFileShareModel().then(function(t){var i,r,n,o,a;n="FileShareItemContent";o="FileShareItemContentType";if(e["FileShareItem"]){r=t.getKeepAliveContext("/FileShareItems(FileShare='"+e.FileShare+"',FileShareItem='"+e.FileShareItem+"')");r.setProperty("FileShareItemContentLink","",null);r.setProperty(o,e[o]);return r.setProperty(n,e[n]).then(function(){return r.getProperty("FileShareItemContentLink")})}if(e.ParentFileShareItem){a="/FileShareItems(FileShare='"+e.FileShare+"',FileShareItem='"+e.ParentFileShareItem+"')/_Children"}else{a="/FileShares(FileShare='"+e.FileShare+"')/_Root/_Children"}i=t.bindList(a);return this._createFile(i,e)}.bind(this)).then(function(e){if(e){l(e)}})};u.prototype._createFile=function(e,t){return new Promise(function(i,r){function n(t){var o,a;o=t.getParameter("success");a=t.getParameter("context");if(o){e.detachCreateCompleted(n);i(a.getProperty("FileShareItemContentLink"))}else{a.destroy();r()}}e.attachCreateCompleted(n);e.create(t,true)})};u.prototype.export=function(e){if(this.bIsDestroyed){Promise.reject("ExportHandler must not be used after calling #destroy")}return this.getExportInstance(e).then(function(e){return e.build().finally(function(){e.destroy()})})};u.prototype.exportAs=function(e,r){var n=this;var o;var a={};if(this.bIsDestroyed){return Promise.reject("ExportHandler must not be used after calling #destroy")}return this.initialized().then(function(){o=Object.assign({},e,n._mDialogSettings);return n.getFileShareContexts()}).then(function(e){return t.getExportSettingsViaDialog(o,n._mCapabilities,e.length>0,function(e){n._oExportDialog=e})}).then(function(i){n._mDialogSettings=i;Object.assign(o,i);t.validateFileSettings(o);a.splitCells=i.splitCells;a.includeFilterSettings=i.includeFilterSettings;if(o.fileType===h.PDF||i.splitCells){o.workbook.columns=t.splitColumns(o.workbook.columns,r)}if(i.includeFilterSettings){return t.parseFilterConfiguration(e.dataSource,r)}return Promise.resolve()}).then(function(e){if(e){var i=o.workbook.context;if(!i){i=o.workbook.context={}}i.metaSheetName=e.name;i.metainfo=Array.isArray(i.metainfo)?i.metainfo.push(e):[e]}if(o.includeFilterSettings){return t.parseTechnicalConfiguration()}return Promise.resolve()}).then(function(e){if(e){var t=o.workbook.context;if(!t){t=o.workbook.context={}}if(Array.isArray(t.metainfo)){e.forEach(function(e){t.metainfo.unshift(e)})}else{t.metainfo=e}}}).then(function(){if(o.destination===s.LOCAL){return Promise.resolve()}return n.getRemoteFileLocation(o.fileName)}).then(function(e){if(e&&!e["FileShareItem"]){e.FileShareItemName=t.validateFileName(e.FileShareItemName,o.fileType)}if(o.fileType===h.GSHEET){return n.validateFileShare(e)}return e}).then(function(e){return n.getExportInstance(o,a,e).then(function(e){return e.build().finally(function(){e.destroy()})})}).catch(i.showErrorMessage)};u.prototype.validateFileShare=function(e){return Promise.all([t.getResourceBundle(),this.getFileShareContexts()]).then(function(t){var i=t[0];var r=t[1];var n=r.find(function(t){return t.getProperty("FileShare")===e.FileShare});return this.isGoogleWorkspace(n)?e:Promise.reject(i.getText("DESTINATION_ERROR_NOT_GOOGLE"))}.bind(this))};u.prototype.getFileShareModel=function(){if(this._oModel){return Promise.resolve(this._oModel)}return t.fetchDataSource().then(function(e){if(e){this._oModel=new a({serviceUrl:e.uri,synchronizationMode:"None",autoExpandSelect:true})}return this._oModel}.bind(this))};u.prototype.isGoogleSheetSupported=function(){return this.getFileShareContexts().then(function(e){return e.some(this.isGoogleWorkspace)}.bind(this))};u.prototype.isGoogleWorkspace=function(e){var t,i;i=e.getProperty("FileShareVendorType");if(new URL(window.location.href).search.indexOf("sap-ui-xx-enableGoogleSheets=true")===-1){return i==="GOOGLE"}t=e.getProperty("FileShareDescription");return i==="GOOGLE"||typeof t==="string"&&t.indexOf("Google")>-1};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportUtils", ["./library","sap/base/Log","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/library","sap/ui/core/syncStyleClass","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/util/openWindow","sap/ui/VersionInfo","sap/ui/core/format/DateFormat"],function(e,t,r,a,i,n,o,l,s,u,f){"use strict";var p=i.ValueState;var c=i.CalendarType;var d=e.FileType;var g=e.EdmType;var y=e.Destination;var m=null;var v=null;var h;var S=r.getLibraryResourceBundle("sap.ui.export",true);var b="sap.ui.export.ExportUtils";var T=/[\\\/\?\*:\[\]]/g;u.load().then(function(e){var t=/^[0-9]+\.[0-9]+/.exec(e.version);m=t?t[0]:null});r.attachLocalizationChanged(function(){v=null});function w(e,t,r,a){var i=Object.keys(r);var n={fileName:"Standard",fileTypeCollection:[],fileType:"XLSX",destinationCollection:[{key:y.LOCAL,text:t.getText("DESTINATION_LOCAL")}],destination:y.LOCAL,paperSize:"DIN_A4",orientation:"LANDSCAPE",splitCells:false,includeFilterSettings:false,addDateTime:false,doEnableAccessibility:false,pdfArchive:false,capabilities:r,fitToPage:false,paperSizeCollection:[{key:"DIN_A4",text:t.getText("PAPER_SIZE_A4")},{key:"US_LETTER",text:t.getText("PAPER_SIZE_US_LETTER")}],orientationCollection:[{key:"LANDSCAPE",text:t.getText("ORIENTATION_LAND")},{key:"PORTRAIT",text:t.getText("ORIENTATION_PORT")}],fontSize:10,signature:false,signatureReason:""};i.forEach(function(e){var r,a;r=e.toUpperCase();a=r+"_FILETYPE";n.fileTypeCollection.push({key:r,text:t.getText(a)})});if(a){n.destinationCollection.push({key:"REMOTE",text:t.getText("DESTINATION_REMOTE")})}var o=Object.assign({},n,e||{});if(!o.fileTypeCollection.some(function(e){return e.key===o.fileType})){o.fileType=o.fileTypeCollection[0].key}return o}function E(e){var t={};["fileName","fileType","paperSize","orientation","splitCells","includeFilterSettings","addDateTime","doEnableAccessibility","fitToPage","fontSize","signature","signatureReason","pdfArchive","destination"].forEach(function(r){t[r]=e[r]});return t}var _={_INTERCEPTSERVICE:"sap/ushell/cloudServices/interceptor/InterceptService",interceptUrl:function(e){var t=sap.ui.require(_._INTERCEPTSERVICE);if(t){var r=t.getInstance();if(r&&r.interceptUrl){e=r.interceptUrl(e)}}return e},fetchDataSource:function(){var e;if(_._oDataSource){return Promise.resolve(_._oDataSource)}e=r.getConfiguration().getFileShareSupport();if(!e){return Promise.resolve()}return new Promise(function(t){sap.ui.require([e],function(e){e.getDataSource().then(function(e){_._oDataSource=e;t(e)}).catch(function(){t()})})})},normalizeUrl:function(e){return e?new URL(e,document.baseURI).toString():e},getExportSettingsViaDialog:function(e,t,i,s,u){return new Promise(function(f,c){var g;if(typeof i==="object"){u=s;s=i}else if(typeof i==="function"){u=i}else if(typeof s==="function"){u=s}S.then(function(m){var v=new o;v.setData(w(e,m,t,i));a.load({name:"sap.ui.export.fragments.SettingsDialog",type:"XML",controller:{isPDF:function(e){return e===d.PDF},isSpreadsheet:function(e){return e===d.XLSX||e===d.GSHEET},isDestinationEnabled:function(e){return e===d.XLSX},hasDestinations:function(e){return e.length>1},formatExportButton:function(e){return e===y.LOCAL?m.getText("EXPORT_BUTTON"):m.getText("DIALOG_BUTTON_CLOUD_DESTINATION")},onCancel:function(){g._bSuccess=false;g.close()},onExport:function(){g._bSuccess=true;g.close()},onFileNameChange:function(e){var t=e.getSource();var a=e.getParameter("value");var i=/[\\/:|?"*<>]/;var n=r.byId("exportSettingsDialog-exportButton");var o=i.test(a);if(o){t.setValueState(p.Error);t.setValueStateText(m.getText("FILENAME_ERROR"))}else if(a.length>100){t.setValueState(p.Warning);t.setValueStateText(m.getText("FILENAME_WARNING"))}else{t.setValueState(p.None);t.setValueStateText(null)}n.setEnabled(!o)},onFileTypeChange:function(e){var t=e.getParameter("selectedItem");if(!t){return}switch(t.getKey()){case d.PDF:v.setProperty("/includeFilterSettings",false);v.setProperty("/destination",y.LOCAL);break;case d.GSHEET:v.setProperty("/destination",y.REMOTE);break;default:r.byId("exportSettingsDialog-signatureReason").setVisible(false);r.byId("exportSettingsDialog-signatureReasonLabel").setVisible(false)}},onFontSizeChange:function(e){var t=e.getSource();var a=e.getParameter("value");var i=/[^\d]/g;var n=r.byId("exportSettingsDialog-exportButton");var o=i.test(a);if(o){t.setValueState(p.Error);t.setValueStateText(m.getText("NUMBER_ERROR"))}else{t.setValueState(p.None);t.setValueStateText(null)}n.setEnabled(!o)},onAfterClose:function(){if(g._bSuccess){f(E(v.getData()))}else{c(null)}g.destroy();g=null}}}).then(function(e){g=e;g.setModel(v);g.setModel(new l({bundle:m}),"i18n");if(s){n("sapUiSizeCompact",s,g)}g.open();if(u){u(g)}})})})},_getFormattedFilterValue:function(e){return e instanceof Date?e.toISOString():e},_getReadableFilterValue:function(e){switch(e.op||e.name){case"==":return"="+_._getFormattedFilterValue(e.right.value);case">":case"<":case"!=":case"<=":case">=":return e.op+_._getFormattedFilterValue(e.right.value);case"between":return _._getFormattedFilterValue(e.args[1].value)+"..."+_._getFormattedFilterValue(e.args[2].value);case"contains":return"*"+e.args[1].value+"*";case"endswith":return"*"+e.args[1].value;case"startswith":return e.args[1].value+"*";default:throw Error("getReadableFilter")}},_parseFilter:function(e){switch(e.type){case"Logical":return _._parseLogical(e);case"Binary":return _._parseBinary(e);case"Unary":return _._parseUnary(e);case"Call":return _._parseCall(e);default:throw Error("Filter type "+e.type+" not supported")}},_parseLogical:function(e){var t,r;if(e.op=="&&"&&e.left.type==="Binary"&&e.right.type==="Binary"&&e.left.op===">="&&e.right.op==="<="&&e.left.left.path===e.right.left.path){return _._parseCall({args:[{path:e.left.left.path,type:"Reference"},{type:"Literal",value:e.left.right.value},{type:"Literal",value:e.right.right.value}],name:"between",type:"Call"})}t=_._parseFilter(e.left).concat(_._parseFilter(e.right));if(e.op==="||"&&t.length){r=t[0].key;if(t.every(function(e){return e.key===r})){t=[{key:r,value:t.reduce(function(e,t){var r=e?"; ":"";return e+r+t.value},"")}]}}return t},_parseBinary:function(e){if(!e.left||e.left.type!="Reference"||!e.right||e.right.type!="Literal"){return[]}return[{key:e.left.path,value:_._getReadableFilterValue(e)}]},_parseUnary:function(e){var t;if(!e.arg){return[]}t=_._parseFilter(e.arg);t[0].value="!"+t[0].value;return t},_parseCall:function(e){if(!e.args||e.args.length<2){return[]}return[{key:e.args[0].path,value:_._getReadableFilterValue(e)}]},parseFilterConfiguration:function(e,r){return new Promise(function(a,i){S.then(function(n){var o,l;o={name:n.getText("FILTER_HEADER"),items:[]};if(!e||!(e.isA("sap.ui.model.ListBinding")||e.isA("sap.ui.model.TreeBinding"))){t.error("A ListBinding is required for parsing the filter settings");i();return null}var s=e.getFilterInfo();if(s){o.items=_._parseFilter(s)}if(typeof r==="function"){o.items.forEach(function(e){l=r(e.key);e.key=l&&typeof l==="string"?l:e.key})}o.items.sort(function(e,t){var r=e.key.toLowerCase();var a=t.key.toLowerCase();if(r>a){return 1}if(r<a){return-1}return 0});a(o);return n})})},parseTechnicalConfiguration:function(){var e,t,r;e=[];r=sap.ushell&&sap.ushell.Container;return _.getResourceBundle().then(function(r){t=r;e.push({name:t.getText("TECHNICAL_INFORMATION"),items:[{key:t.getText("CREATED_TIME"),value:f.getDateTimeWithTimezoneInstance().format(new Date)}]})}).then(function(){return r&&typeof r.getServiceAsync==="function"?r.getServiceAsync("UserInfo"):undefined}).then(function(r){if(r&&r.getFullName()){e[0].items.unshift({key:t.getText("USER_NAME"),value:r.getFullName()})}return e})},saveAsFile:function(e,t){var r,a,i;if(!(e instanceof Blob)){return}r=document.createElementNS("http://www.w3.org/1999/xhtml","a");a="download"in r;if(a){i=function(e,t){r.download=t;r.href=URL.createObjectURL(e);r.dispatchEvent(new MouseEvent("click"))}}if(typeof i==="undefined"){i=function(e){var t=new FileReader;t.onloadend=function(){var e,r;r=t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e=s(r,"_blank");if(!e){window.location.href=r}};t.readAsDataURL(e)}}i(e,t)},validateSettings:function(e){_._validateDataSource(e.dataSource);_.validateFileSettings(e);if(typeof e.showProgress!=="boolean"){e.showProgress=true}_._validateWorkbook(e.workbook);if(typeof e.worker!=="boolean"){e.worker=true}_._validateScaleCustomizing(e.customizing,"currency");_._validateScaleCustomizing(e.customizing,"unit")},validateFileSettings:function(e){e.fileType=d[e.fileType]?e.fileType:d.XLSX;e.fileName=_.validateFileName(e.fileName,e.fileType)},validateFileName:function(e,r){var a;e=e||"export";a="."+r.toLowerCase();if(!e.endsWith(a)&&r!==d.GSHEET){e+=a;t.info(b+": fileName was missing the proper file extension - extension has been added")}return e},_validateDataSource:function(e){var r;if(!e||typeof e!=="object"){throw new Error(b+": dataSource has not been specified")}e.type=typeof e.type==="string"&&e.type.toLowerCase()||"odata";if(e.type==="array"&&!Array.isArray(e.data)){t.warning(b+": Defined type does not match the provided data")}if(Array.isArray(e.data)){e.count=e.data.length}if(e.type==="odata"){if(typeof e.dataUrl!=="string"||e.dataUrl.length===0){throw new Error(b+": Unable to export data. No dataUrl provided.")}if(e.dataUrl){e.dataUrl=_.normalizeUrl(e.dataUrl)}if(e.serviceUrl){e.serviceUrl=_.normalizeUrl(e.serviceUrl)}}if(typeof e.count!=="number"||e.count<0||isNaN(e.count)||e.count%1!==0){t.info(b+": Invalid value for dataSource.count - value will be ignored");e.count=null}if(typeof e.useBatch!=="boolean"){e.useBatch=false;t.info(b+': Parameter useBatch not provided. Applying default value "false"')}else if(e.useBatch===true){if(typeof e.serviceUrl!=="string"||e.serviceUrl.length===0){e.useBatch=false;t.warning(b+": serviceUrl is required for OData batch requests")}if(typeof e.headers!=="object"){e.useBatch=false;t.warning(b+": headers are required for OData batch requests.")}}r=e.sizeLimit;if(!r||isNaN(r)||r%1!==0){var a=5e3,i=200;r=e.count?Math.round(e.count/(i*5))*i:i;r=Math.min(a,Math.max(r,i));e.sizeLimit=r;t.info(b+": No valid sizeLimit provided. sizeLimit is set to "+r)}},_validateWorkbook:function(e){if(!(e instanceof Object)||!Array.isArray(e.columns)){throw new Error(b+"column configuration is not provided. Export is not possible")}e.columns=e.columns.filter(function(e,a){var i;if(!(e instanceof Object)){t.error(b+": Column "+a+" skipped due to invalid configuration");return false}if(Array.isArray(e.property)&&e.type!==g.String&&e.type!=null){t.warning(b+": Type "+e.type+" does not support an array of properties");e.property=e.property[0]}if(typeof e.property!=="string"&&!Array.isArray(e.property)){t.error(b+": Column "+a+" skipped due to missing mandatory property");return false}e.label=e.label||(e.property instanceof Array?e.property[0]:e.property);i=e.width;if(typeof i==="string"){var n;n=i.toLowerCase();i=parseFloat(n);if(n.indexOf("em")>0){i=i*2}else if(n.indexOf("px")>0){i=i/8}}if(isNaN(i)||i<1){i=10}e.width=Math.round(i);_._validateType(e,a);_._validateString(e,"textAlign");if(e.textAlign){var o=(e.textAlign+"").toLowerCase();if(["begin","end"].indexOf(o)>-1){var l=["left","right"];o=(r.getConfiguration().getRTL()?l.reverse():l)[["begin","end"].indexOf(o)]}if(o!==""&&["left","right","center"].indexOf(o)==-1){t.warning(b+": Incorrect column alignment value "+o+' on column "'+(e.label||e.property)+'". Default alignment is used.');o=""}e.textAlign=o}["autoScale","delimiter","displayTimezone","displayUnit","utc","wrap"].forEach(function(t){_._validateProperty(e,t,"boolean")});["inputFormat","unit","unitProperty","template","trueValue","falseValue","timezone","timezoneProperty"].forEach(function(t){_._validateString(e,t)});if(e.template&&!Array.isArray(e.property)&&typeof e.inputFormat!=="string"){t.warning(b+': Template is not applicable on a single property without inputFormat - value will be discarded on column "'+(e.label||e.property)+'".');delete e.template}if(typeof e.calendar==="string"&&[c.Gregorian,c.Islamic,c.Japanese].indexOf(e.calendar)<0){t.warning(b+': Unsupported calendar "'+e.calendar+'" on column "'+(e.label||e.property)+'". Value will be discarded.');delete e.calendar}if(e.type===g.Boolean&&(e.trueValue===null||e.falseValue===null)){t.warning(b+': The properties trueValue and falseValue have to be assigned correctly on column "'+(e.label||e.property)+'". Values will be discarded.');delete e.trueValue;delete e.falseValue}if(e.autoScale===true&&(e.type!==g.Number||!e.unit&&!e.unitProperty)){t.warning(b+": autoScale cannot be taken into account due to invalid configuration.");delete e.autoScale}if(e.type===g.DateTime){if(!e.timezone){e.timezone=e.utc===false?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"UTC"}if(e.property===e.timezoneProperty||typeof e.timezoneProperty==="string"&&e.timezoneProperty.split(",").length>1){t.warning(b+": Property timezoneProperty is invalid.");delete e.timezoneProperty}}else if(typeof e.utc==="boolean"){t.warning(b+": Property utc is only supported for type DateTime.");delete e.utc}var s=e.scale;if(e.type===g.Number&&isNaN(s)&&s!=="variable"){t.warning(b+": scale parameter for numerical column configuration is missing.")}if(typeof s==="string"){s=parseInt(s)}if(isNaN(s)){s=null}e.scale=s;if(e.valueMap&&typeof e.valueMap!=="object"){t.warning(b+': Invalid value for property "valueMap" on column "'+(e.label||e.property)+'". Value will be discarded.');delete e.valueMap}return true});_._validateWorkbookContext(e.context);_._validateString(e,"hierarchyLevel")},_validateType:function(e){var r,a;if(typeof e.type!=="string"){e.type=g.String;return}if(!g[e.type]){a=g.String;for(r in g){if(r.toLowerCase()==e.type.toLowerCase()){a=r}}t.warning(b+": Unsupported column type "+e.type+' on column "'+(e.label||e.property)+'". EdmType.'+a+" is applied.");e.type=a}switch(e.type){case g.Date:if(!e.format&&!e.calendar){_._validateString(e,"format",_.getFormatSettings().datePattern);_._validateString(e,"calendar",_.getFormatSettings().calendar)}break;case g.DateTime:if(!e.format&&!e.calendar){_._validateString(e,"format",_.getFormatSettings().dateTimePattern);_._validateString(e,"calendar",_.getFormatSettings().calendar)}break;case g.Time:_._validateString(e,"format",_.getFormatSettings().timePattern);break;case g.Number:break;case g.Currency:if(!e.unitProperty){t.warning(b+': Missing unitProperty for type Currency on column "'+(e.label||e.property)+'". Type is reverted to "String".');e.type=g.String}break;case g.Enumeration:if(!e.valueMap||typeof e.valueMap!=="object"){t.warning(b+': Invalid valueMap for type Enumeration on column "'+(e.label||e.property)+'". Type is reverted to "String".');e.type=g.String}break;default:}},_validateWorkbookContext:function(e){if(!(e instanceof Object)){return}_._validateString(e,"application","SAP UI5");_._validateString(e,"version",m);_._validateString(e,"title");_._validateString(e,"modifiedBy");_._validateString(e,"sheetName","SAPUI5 Spreadsheet Export",31,T);_._validateString(e,"metaSheetName","Metadata",31,T);if(e.metainfo){if(!Array.isArray(e.metainfo)){t.warning(b+': Invalid value for property "metainfo". Value will be discarded.');e.metainfo=null}else{e.metainfo.filter(function(e,r){if(typeof e.name!=="string"||e.name.length===0){t.warning(b+": Invalid name for metainfo group at index "+r+". Entry will be discarded.");return false}return true})}}},_validateString:function(e,r,a,i,n){var o;_._validateProperty(e,r,"string",a);o=e[r];if(typeof o==="string"&&(typeof n==="string"||n instanceof RegExp)){o=o.replace(n,"")}if(typeof o==="string"&&i&&o.length>i){t.warning(b+": The value of "+r+" exceeds the max length of "+i+" and will be truncated.");o=o.slice(0,i)}e[r]=o},_validateProperty:function(e,r,a,i){var n=e[r];if(n!=null&&typeof n!==a){t.warning(b+': Invalid value for property "'+r+". Value will be discarded.");n=null}if(n==null&&typeof i!=="undefined"){n=i}if(n==null){delete e[r]}else{e[r]=n}},_validateScaleCustomizing:function(e,r){var a,i;if(!e){return}i=e[r];if(!(i instanceof Object)||Array.isArray(i)){t.warning(b+": Invalid scale customizing for "+r+".");e[r]={}}else{for(a in i){if(!(i[a]instanceof Object)){t.warning(b+": Key "+a+" has been removed from customizing.");delete i[a]}else if(typeof i[a].scale!=="number"||i[a].scale<0){t.warning(b+": Key "+a+" has been removed from customizing due to invalid scale.");delete i[a]}}}},getExportInstance:function(e){var t,r;r=typeof e.fileType==="string"?e.fileType.toUpperCase():e.fileType;switch(r){case d.PDF:t="sap/ui/export/PortableDocument";break;default:t="sap/ui/export/Spreadsheet"}return new Promise(function(r){sap.ui.require([t],function(t){r(new t(e))})})},getCountFromBinding:function(e){var t;if(typeof e.getCount==="function"){t=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){t=e.getLength()}if(typeof t!=="number"||t<0||isNaN(t)){t=null}return t},splitColumns:function(e,t){var r=[];if(typeof t!=="function"){t=function(){}}e.forEach(function(e){var a,i,n,o;if(Array.isArray(e.property)&&e.property.length>1){i=Object.assign({},e);i.property=e.property[0];i.label=t(i.property)||e.label;delete i.template;a=[i];e.property.slice(1).forEach(function(r,i){o=t(r);n={property:r,label:o||e.label+" ("+(i+1)+")"};a.push(n)})}if(e.unitProperty&&e.displayUnit!==false){i=Object.assign({},e);o=t(e.unitProperty);a=[i,{property:e.unitProperty,label:o||e.label+" (1)"}];if(i.type===g.Currency){i.displayUnit=false}if(i.type===g.Number){delete i.unitProperty}}if(e.timezoneProperty&&e.displayTimezone!==false){i=Object.assign({},e);o=t(e.timezoneProperty);a=[i,{property:e.timezoneProperty,label:o||e.label+" (1)"}];i.displayTimezone=false}r.push(a||e)});return r.flat()},getResourceBundle:function(){if(!h){return r.getLibraryResourceBundle("sap.ui.export",true).then(function(e){h=e;return h})}return Promise.resolve(h)},getFormatSettings:function(){if(!v){var e,t;t={};e=r.getConfiguration().getFormatSettings();t.calendar=r.getConfiguration().getCalendarType();t.datePattern=e.getDatePattern("medium");t.timePattern=e.getTimePattern("medium");t.delimiter=!!e.getNumberSymbol("group");if(typeof t.datePattern==="string"){t.datePattern=t.datePattern.toLowerCase()}if(typeof t.timePattern==="string"){t.timePattern=t.timePattern.toLowerCase().replace(/ a+/," AM/PM")}if(t.datePattern&&t.timePattern){t.dateTimePattern=t.datePattern+" "+t.timePattern}v=t}return v}};return _},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/PortableDocument", ["sap/base/Log","sap/m/MessageToast","sap/ui/core/Core","sap/ui/export/ExportBase","sap/ui/export/ExportUtils","sap/ui/model/odata/v4/ODataModel"],function(e,t,r,o,n,i){"use strict";var a=o.extend("sap.ui.export.PortableDocument",{constructor:function(e){o.call(this,e);["paperSize","orientation","font","fontSize","doEnableAccessibility","fitToPage","signature","signatureReason","pdfArchive"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this))}});a.prototype.processDataSource=function(t){var r=null;var o=typeof t;if(!t){return null}if(o!="object"){e.error("Spreadsheet#processDataSource: Unable to apply data source of type "+o);return null}if(t.dataUrl&&t.serviceUrl){r=t}if(t.isA&&t.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){r=this.createDataSourceFromBinding(t)}return r};a.prototype.createDataSourceFromBinding=function(t){var r=null;if(t.isA("sap.ui.model.ClientListBinding")){e.error("Unable to create dataSource configuration due to not supported Binding: "+t.getMetadata().getName())}if(t.isA("sap.ui.model.ClientTreeBinding")){e.error("Unable to create dataSource configuration due to not supported Binding: "+t.getMetadata().getName())}if(typeof t.getDownloadUrl==="function"){var o=t.getModel(),i=n.interceptUrl(t.getDownloadUrl("pdf")),a=n.interceptUrl(o.sServiceUrl),s=o.isA("sap.ui.model.odata.v4.ODataModel");var u=new URL(i,document.baseURI);u.hash="";this._oModel=o;u.search=u.search.split("&").filter(function(e){return e.indexOf("$format")==-1}).join("&");r={type:"odata",version:s?4:2,dataUrl:u.toString(),serviceUrl:a.split("/").slice(0,-5).join("/")+"/default/iwbep/common/0001/",headers:s?o.getHttpHeaders(true):o.getHeaders()}}return r};a.prototype._createDocumentDescription=function(e){var t=e.workbook;var r,o;r={Title:t.context.title,Format:{PaperSize:e.paperSize,Orientation:e.orientation,FontSize:Number(e.fontSize),FitToPage:{IsEnabled:e.fitToPage,MinimumFontSize:4}},PDFStandard:{DoEnableAccessibility:e.doEnableAccessibility,UsePDFAConformance:e.pdfArchive},Signature:{DoSign:e.signature,Reason:e.signatureReason},CoverPage:[],TableColumns:[]};o=t.context.metainfo;if(o instanceof Array){if(e.dataSource.version==2){o.forEach(function(e){e.items.forEach(function(t){var o={Title:e.name,Name:t.key,Value:t.value};r["CoverPage"].push(o)})})}else{o.forEach(function(e){var t={Title:e.name,Content:[]};e.items.forEach(function(e){t["Content"].push({Name:e.key,Value:e.value})});r["CoverPage"].push(t)})}}t.columns.filter(function(e,t,r){var o=Array.isArray(e.property)?e.property[0]:e.property;return r.findIndex(function(e){var t=Array.isArray(e.property)?e.property[0]:e.property;return o===t})===t}).forEach(function(e){r["TableColumns"].push({Name:Array.isArray(e.property)?e.property[0]:e.property,Header:e.label})});return r};a.prototype._getEntitySetName=function(e){var t=e&&e.version||2;return t==4?"MyDocumentDescriptions":"SAP__MyDocumentDescriptions"};a.prototype._getModel=function(e){var t=e.version||2;return t===4?new i({serviceUrl:e.serviceUrl,synchronizationMode:"None"}):this._oModel};a.prototype.setDefaultExportSettings=function(e){var t=e&&e.workbook&&e.workbook.context;if(!(t instanceof Object)){t=e.workbook.context={}}if(typeof t.title==="string"&&t.title){return Promise.resolve()}return r.getLibraryResourceBundle("sap.ui.export",true).then(function(e){t.title=e.getText("XLSX_DEFAULT_TITLE")})};a.prototype.postDocumentDescription=function(e,t){var r,o,n;o=this._getModel(t);n="/"+this._getEntitySetName(t);if(!o||!o.isA(["sap.ui.model.odata.v4.ODataModel","sap.ui.model.odata.v2.ODataModel"])){return Promise.reject("Unsupported Model")}return new Promise(function(t,i){if(o.isA("sap.ui.model.odata.v4.ODataModel")){r=o.bindList(n);r.attachCreateCompleted(function(e){var r=e.getParameter("success");if(r){t(e.getParameter("context").getObject()["Id"])}else{i()}});r.create(e)}else{var a=o.bUseBatch;o.setUseBatch(false);o.create(n,e,{success:function(e){o.setUseBatch(a);t(e["Id"])},error:function(e){o.setUseBatch(a);i(e)}})}})};a.prototype.createBuildPromise=function(e){var t=this;var o;var i;var a=r.getLibraryResourceBundle("sap.ui.export");i=new sap.m.BusyDialog("PDFExportBusyDialog",{title:a.getText("PROGRESS_TITLE"),text:a.getText("PDF_GENERATION_IN_PROGRESS"),showCancelButton:true,close:function(e){if(e.getParameter("cancelPressed")){t.cancel();i.destroy();i=null}}});o=t._createDocumentDescription(e);return t.postDocumentDescription(o,e.dataSource).then(function(r){i.open();return i&&t.sendRequest(e.dataSource.dataUrl,r).then(function(t){n.saveAsFile(t,e.fileName);i.destroy()}).catch(function(e){i.destroy();sap.m.MessageToast.show("Error during PDF export!")})})};a.prototype.sendRequest=function(e,t){return new Promise(function(r,o){var n=this.request=new XMLHttpRequest;n.open("GET",e);n.responseType="blob";n.setRequestHeader("Accept",this.getMimeType());n.setRequestHeader("SAP-Document-Description-Id",t);n.addEventListener("abort",function(){o("Request aborted")});n.addEventListener("error",function(){o("Error occured while requesting data")});n.addEventListener("load",function(){var e=n.status;if(e>=200&&e<400){r(n.response)}else{o(n.response)}});n.send()}.bind(this))};a.prototype.getMimeType=function(){return"application/pdf"};a.prototype.cancel=function(){if(this.request&&this.request.readyState!=XMLHttpRequest.DONE){this.request.abort();this.request=null}};a.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments);this._oModel=null};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/Spreadsheet", ["sap/ui/core/Core","./ExportDialog","sap/ui/export/ExportBase","sap/ui/Device","sap/ui/export/SpreadsheetExport","sap/base/Log","sap/ui/export/ExportUtils"],function(e,t,r,o,i,s,n){"use strict";var a="sap.ui.export.Spreadsheet";var u=r.extend(a,{constructor:function(e){r.call(this,e);this._mSettings.customizing={};this._mSettings.showProgress=true;this._mSettings.worker=true;["showProgress","worker"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this));this.codeListsPromise=this.codeListsPromise instanceof Promise?this.codeListsPromise:Promise.resolve()}});function c(e,t,r){if(!(r[e]instanceof Object)){r[e]={}}if(!isNaN(t.digits)){r[e].scale=t.digits}if(!isNaN(t.UnitSpecificScale)){r[e].scale=t.UnitSpecificScale}if(isNaN(r[e].scale)){delete r[e]}}u.prototype.setDefaultExportSettings=function(t){var r,o,i;o=t.customizing.currency={};var s=e.getConfiguration().getFormatSettings().getCustomCurrencies();if(s){for(r in s){c(r,s[r],o)}}return this.codeListsPromise.then(function(e){var r,s,n;if(!Array.isArray(e)){return}i=t.customizing.unit={};r=e[0];s=e[1];for(n in r){c(n,r[n],o)}for(n in s){c(n,s[n],i)}}).then(function(){return e.getLibraryResourceBundle("sap.ui.export",true)}).then(function(e){var r=t.workbook.context;if(!(r instanceof Object)){r=t.workbook.context={}}if(!r.title){r.title=e.getText("XLSX_DEFAULT_TITLE")}if(!r.sheetName){r.sheetName=e.getText("XLSX_DEFAULT_SHEETNAME")}})};u.requestCodeLists=function(e){if(!e.isA(["sap.ui.model.odata.ODataMetaModel","sap.ui.model.odata.v4.ODataMetaModel"])){return Promise.resolve([null,null])}return Promise.all([e.requestCurrencyCodes(),e.requestUnitsOfMeasure()]).catch(function(e){s.warning(a+": Code lists cannot be processed due to the following error - "+e);return Promise.resolve([null,null])})};u.prototype.attachBeforeSave=function(e,t,r){return this.attachEvent("beforeSave",e,t,r)};u.prototype.detachBeforeSave=function(e,t){return this.detachEvent("beforeSave",e,t)};u.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null}return this};u.prototype.getMimeType=function(){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};u.prototype.onprogress=function(e,t){var r;if(isNaN(e)||isNaN(t)){return}r=Math.round(e/t*100);s.debug("Spreadsheet export: "+r+"% loaded.")};u.prototype.createDataSourceFromBinding=function(e){var t=[];if(e.isA("sap.ui.model.ClientListBinding")){var r=e.getModel().getProperty(e.getPath());t={data:r instanceof Array?r:[],type:"array"}}if(e.isA("sap.ui.model.ClientTreeBinding")){s.error("Unable to create dataSource configuration due to not supported Binding: "+e.getMetadata().getName())}if(typeof e.getDownloadUrl==="function"){var o=e.getModel(),i=e.getDownloadUrl("json"),a=o.sServiceUrl,c=o.isA("sap.ui.model.odata.v4.ODataModel");i=n.interceptUrl(i);a=n.interceptUrl(a);t={type:"odata",dataUrl:i,serviceUrl:a,headers:c?o.getHttpHeaders(true):o.getHeaders(),count:n.getCountFromBinding(e),useBatch:c||o.bUseBatch};if(o.getMetaModel()&&typeof o.getMetaModel().requestCurrencyCodes==="function"&&typeof o.getMetaModel().requestUnitsOfMeasure==="function"){this.codeListsPromise=u.requestCodeLists(o.getMetaModel(),this._mSettings)}}return t};u.prototype.processDataSource=function(e){var t=null;var r=typeof e;if(!e){return null}if(r=="string"){return{count:this._mSettings.count,dataUrl:e,type:"odata",useBatch:false}}if(r!="object"){s.error("Spreadsheet#processDataSource: Unable to apply data source of type "+r);return null}if(e instanceof Array){t={data:e,type:"array"}}if(e.dataUrl){t=e}if(e.isA&&e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){t=this.createDataSourceFromBinding(e)}return t};u.prototype.createBuildPromise=function(e){var r=this;return new Promise(function(s,a){var u;var c=1048576;var p=o.system.desktop?2e6:1e5;var f=e.dataSource.type=="array"?e.dataSource.data.length:e.dataSource.count;var l=e.workbook.columns.length;function d(o){if(o.progress){if(u){u.updateStatus(o.fetched,o.total)}r.onprogress(o.fetched,o.total)}if(o.finished&&r.process!==null){r.process=null;if(!o.spreadsheet){a();return}var i=r.fireEvent("beforeSave",{data:o.spreadsheet,exportDialog:u},true,true);if(i){if(u){window.setTimeout(u.finish,1e3)}n.saveAsFile(new Blob([o.spreadsheet],{type:r.getMimeType()}),e.fileName)}s()}if(typeof o.error!="undefined"){var c=o.error.message||o.error;r.process=null;if(u){u.finish()}a(c);t.showErrorMessage(c)}}function g(){if(!e.showProgress){if(r.process){a("Cannot start export: the process is already running");return}r.process=i.execute(e,d);return}t.getProgressDialog().then(function(t){u=t;if(r.process){a("Cannot start export: the process is already running");return}u.oncancel=function(){return r.process&&r.process.cancel()};u.open();u.updateStatus(0,e.dataSource.count);r.process=i.execute(e,d)})}if(l<=0){a("No columns to export.")}else if(f*l>p||!f||f>=c){var h={rows:f,columns:l,sizeLimit:f*l>p,cutOff:f>=c};t.showWarningDialog(h).then(g).catch(function(){a("Export cancelled by the user.")})}else{g()}})};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/SpreadsheetExport", ["sap/base/Log","sap/ui/export/ExportUtils"],function(e,r){"use strict";var t="sap/ui/export/provider/DataProviderBase",n="sap/ui/export/js/XLSXBuilder",o="sap/ui/export/js/libs/JSZip3";var i={execute:function(i,a){function s(e){if(e instanceof MessageEvent&&e.data){e=e.data}if(typeof a==="function"){a(e)}}function u(e,r){s({progress:true,fetched:e||0,total:r||0})}function c(e){s({error:e.message||e})}function f(e){s({finished:true,spreadsheet:e})}function p(){var e;var r;function a(t,n){r=t.getDataConverter(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);var o=i.dataSource.data||[];var a=o.length;var s=r(o.slice());e.append(s);u(a,a);e.build().then(f)}sap.ui.require([t,n,o],a);return{cancel:f}}function l(){var e,r;function a(t,n){var o=new t(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);r=o.requestData(s)}function s(r){if(r.error||typeof r.error==="string"){c(r.error);return}e.append(r.rows);u(r.fetched,r.total);if(r.finished){e.build().then(f)}}function p(){r.cancel();f()}sap.ui.require([t,n,o],a);return{cancel:p}}function d(){var t;var n={};var o=function(){t.postMessage({cancel:true});f()};function a(e){var r=new Worker(e);r.onmessage=s;if(navigator.userAgent.indexOf("Firefox")===-1||u(e)){r.onerror=c}r.postMessage(i);return r}function u(e){return e.indexOf(window.location.host)>0||/^[^/]+\/[^/].*$|^\/[^/].*$/i.test(e)}function p(){var r,t;e.warning("Direct worker is not allowed. Load the worker via blob.");r='self.origin = "'+n.base+'"; '+'importScripts("'+n.src+'")';t=window.URL.createObjectURL(new Blob([r]));return a(t)}function d(){e.warning("Blob worker is not allowed. Use in-process export.");o=l(i).cancel}function v(){try{t=a(n.src);t.addEventListener("error",function(e){t=p();t.addEventListener("error",function(e){d();e.preventDefault()});e.preventDefault()})}catch(e){try{t=p()}catch(e){d()}}}n.base=r.normalizeUrl(sap.ui.require.toUrl("sap/ui/export/js/"));n.src=n.base+"SpreadsheetWorker.js";v();return{cancel:function(){o()}}}if(i.dataSource.type==="array"){return p()}else if(i.worker===false||sap.ui.disableExportWorkers===true){return l()}else{return d()}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/library", ["jquery.sap.global","sap/ui/core/library"],function(jQuery,e){"use strict";var r=sap.ui.getCore().initLibrary({name:"sap.ui.export",dependencies:["sap.ui.core"],types:["sap.ui.export.EdmType","sap.ui.export.FileType"],interfaces:[],controls:[],elements:[],version:"1.109.0"});r.EdmType={BigNumber:"BigNumber",Boolean:"Boolean",Currency:"Currency",Date:"Date",DateTime:"DateTime",Enumeration:"Enumeration",Number:"Number",Percentage:"Percentage",String:"String",Time:"Time"};r.FileType={CSV:"CSV",GSHEET:"GSHEET",PDF:"PDF",XLSX:"XLSX"};r.Destination={LOCAL:"LOCAL",REMOTE:"REMOTE"};sap.ui.loader.config({shim:{"sap/ui/export/js/XLSXBuilder":{amd:true,exports:"XLSXBuilder"},"sap/ui/export/js/XLSXExportUtils":{amd:true,exports:"XLSXExportUtils"}}});return r});
sap.ui.require.preload({
	"sap/ui/export/fragments/SettingsDialog.fragment.xml":'<Dialog xmlns="sap.m" xmlns:core="sap.ui.core" id="exportSettingsDialog" title="{i18n>EXPORT_SETTINGS_TITLE}" horizontalScrolling="false" verticalScrolling="true" afterClose=".onAfterClose" class="sapUiContentPadding sapUiExportSettings"><content><VBox renderType="Bare" width="100%" class="sapUiExportSettingsLabel"><Label text="{i18n>FILE_NAME}" labelFor="exportSettingsDialog-fileName"/><Input id="exportSettingsDialog-fileName" value="{/fileName}" liveChange=".onFileNameChange" class="sapUiTinyMarginBottom"/><Label text="{i18n>SELECT_FORMAT}" labelFor="exportSettingsDialog-fileType"/><Select id="exportSettingsDialog-fileType" selectedKey="{/fileType}" items="{path: \'/fileTypeCollection\'}" change=".onFileTypeChange" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>SELECT_DESTINATION}" labelFor="exportSettingsDialog-destination" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}"/><Select id="exportSettingsDialog-destination" selectedKey="{/destination}" items="{path: \'/destinationCollection\'}" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}" enabled="{path: \'/fileType\', formatter: \'.isDestinationEnabled\'}" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><CheckBox id="exportSettingsDialog-includeFilterSettings" selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-includeFilterSettings-PDF" enabled="{/capabilities/PDF/CoverPage}"  selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{path:\'/fileType\', formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FILTER_SETTINGS}"/><CheckBox id="exportSettingsDialog-pdfArchive" enabled="{/capabilities/PDF/ArchiveFormat}" selected="{/pdfArchive}" text="{i18n>ARCHIVE_FORMAT}"  visible="{path:\'/fileType\', formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_ARCHIVE_FORMAT}"/><CheckBox id="exportSettingsDialog-splitCells" selected="{/splitCells}" text="{i18n>SPLIT_CELLS}" visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-addDateTime" selected="{/addDateTime}" text="{i18n>ADD_DATE_TIME}" visible="false"/><Label text="{i18n>PAPER_SIZE}" labelFor="exportSettingsDialog-papersize" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-papersize" selectedKey="{/paperSize}" items="{path: \'/paperSizeCollection\'}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>ORIENTATION}" labelFor="exportSettingsDialog-orientation" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-orientation" selectedKey="{/orientation}" items="{path: \'/orientationCollection\'}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>FONT_SIZE}" labelFor="exportSettingsDialog-fontSize" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Input id="exportSettingsDialog-fontSize" value="{/fontSize}" enabled="{/capabilities/PDF/FontSize}" liveChange=".onFontSizeChange" class="sapUiTinyMarginBottom" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FONT_SIZE}"/><CheckBox id="exportSettingsDialog-accessibility" selected="{/doEnableAccessibility}" text="{i18n>ENABLE_ACCESSIBILITY}" tooltip="{i18n>TOOLTIP_PDF_ACCESSIBILITY}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-fitToPage" enabled="{/capabilities/PDF/FitToPage}" selected="{/fitToPage}" text="{i18n>FITTOPAGE}" tooltip="{i18n>TOOLTIP_FITTOPAGE}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-signature" enabled="{/capabilities/PDF/Signature}" selected="{/signature}" text="{i18n>ENABLE_SIGNATURE}" tooltip="{i18n>TOOLTIP_PDF_SIGNATURE}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Label id="exportSettingsDialog-signatureReasonLabel" text="{i18n>SIGNATURE_REASON}" labelFor="exportSettingsDialog-signatureReason" visible="{/signature}"/><Input id="exportSettingsDialog-signatureReason" value="{/signatureReason}" class="sapUiTinyMarginBottom" visible="{/signature}"/></VBox></content><beginButton><Button id="exportSettingsDialog-exportButton" press=".onExport" text="{path:\'/destination\', formatter:\'.formatExportButton\'}" type="Emphasized"/></beginButton><endButton><Button id="exportSettingsDialog-cancelButton" press=".onCancel" text="{i18n>CANCEL_BUTTON}" type="Transparent"/></endButton></Dialog>',
	"sap/ui/export/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.export","type":"library","embeds":[],"applicationVersion":{"version":"1.109.0"},"title":"UI5 library: sap.ui.export","description":"UI5 library: sap.ui.export","ach":"CA-UI5-TBL","resources":"resources.json","offline":true,"openSourceComponents":[{"name":"JSZip3","packagedWithMySelf":true,"version":"3.7.1"}]},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.109","libs":{"sap.ui.core":{"minVersion":"1.109.0"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":["sap.ui.export.EdmType","sap.ui.export.FileType"],"interfaces":[]}}}}',
	"sap/ui/export/provider/DataProviderBase.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
(function(t){"use strict";if(typeof sap!=="undefined"&&typeof sap.ui.define==="function"){sap.ui.define([],t,true)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof self!=="undefined"){e=self}else{e=this}e.DataProviderBase=t()}})(function(){"use strict";var t=function(e){this.mSettings=e;this.bCanceled=false;this.iAvailableRows=0;this.mRequest=null;this.iTotalRows=Math.min(e.dataSource.count||t.MAX_ROWS,t.MAX_ROWS);this.iBatchSize=Math.min(e.dataSource.sizeLimit||t.MAX_ROWS,this.iTotalRows);this._prepareDataUrl()};t.MAX_ROWS=1048575;t.HTTP_ERROR_MSG="HTTP connection error";t.HTTP_WRONG_RESPONSE_MSG="Unexpected server response:\n";t._createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,r=t==="x"?e:e&3|8;return r.toString(16)})};t.getColumnsToConvert=function(t){return t.workbook.columns.reduce(function(t,e){var r;r=e.property instanceof Array?e.property:[e.property];if(e.unitProperty){r.push(e.unitProperty)}r.forEach(function(r){var n=r.split("/");if(n.length>1){t.push({property:r,keys:n,type:e.type})}});return t},[])};t.getDataConverter=function(e){var r=this.getColumnsToConvert(e);return function(e){return t._convertData(e,r)}};t._convertData=function(e,r){r.forEach(function(r){e.forEach(function(e){e[r.property]=t._getValue(e,r)})});return e};t._getValue=function(t,e){var r=e.keys.reduce(function(t,e){return t&&t[e]},t);return r};t.prototype.requestData=function(e){var r=this.mSettings.dataSource;this.fnConvertData=t.getDataConverter(this.mSettings);this.fnProcessCallback=e;this.mRequest={serviceUrl:this._cleanUrl(r.serviceUrl),dataUrl:this._getUrl(0,this.iBatchSize),method:r.useBatch?"BATCH":"GET",headers:r.headers};this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this));return{cancel:function(){this.bCanceled=true;if(this.oPendingXHR instanceof XMLHttpRequest){this.oPendingXHR.abort()}}.bind(this)}};t.prototype.fnOnDataReceived=function(t){var e,r,n,s;var i={};this.oPendingXHR=null;if(this.bCanceled){return}e=t&&t.value||t.d&&(t.d.results||t.d)||t;e=Array.isArray(e)?e:[];n=e.length;this.iAvailableRows+=n;s=this.iTotalRows-this.iAvailableRows;i.finished=n===0||s<=0;i.progress=this.iTotalRows;i.total=this.iTotalRows;i.fetched=this.iAvailableRows;r=t&&t["@odata.nextLink"]||t.d&&t.d.__next||null;if(!i.finished){this.mRequest.dataUrl=this._getUrl(this.iAvailableRows,Math.min(this.iBatchSize,s),r);this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this))}i.rows=this.fnConvertData(e);this.fnProcessCallback(i)};t.prototype.fnOnError=function(t){this.fnProcessCallback({error:t})};t.prototype._cleanUrl=function(t){var e;if(!t){return""}e=new URL(t);e.hash=e.search="";e.pathname+=e.pathname.endsWith("/")?"":"/";return e.toString()};t.prototype._prepareDataUrl=function(){var t=this.mSettings.dataSource;var e,r=/\$skip\=[0-9]+/,n=/\$top\=[0-9]+/;if(!t.dataUrl){throw"Unable to load data - no URL provided."}e=new URL(t.dataUrl);e.search=e.search||"";if(!r.test(e.search)){e.search+=(e.search.length?"&$skip=":"$skip=")+0}if(!n.test(e.search)){e.search+="&$top="+0}this.mSettings.dataSource.dataUrl=e.toString()};t.prototype._getUrl=function(t,e,r){var n,s;n=new URL(this.mSettings.dataSource.dataUrl);if(r){s=new URL(r,n.origin);n.search=s.search}else{n.search=(n.search||"").replace(/\$skip\=[0-9]+/g,"$skip="+t).replace(/\$top\=[0-9]+/g,"$top="+e)}return n.toString()};t.prototype.sendRequest=function(t){var e;if(typeof t!=="object"||t===null||typeof t.dataUrl!=="string"){throw new Error("Unable to send request - Mandatory parameters missing.")}e=(t.method==="BATCH"&&t.serviceUrl?this.sendBatchRequest:this.sendGetRequest).bind(this);return e(t)};t.prototype.sendBatchRequest=function(e){return new Promise(function(r,n){var s=new XMLHttpRequest;var i="batch_"+t._createGuid();var a=e.dataUrl.split(e.serviceUrl)[1];var o=[];var h,c;s.onload=function(){var e,s,i,a,o,h,c;s=this.responseText.split("\r\n");o=0;a=s.length;i=a-1;s.forEach(function(t){c=t.match(/^HTTP\/1\.[0|1] ([1-9][0-9]{2})/);if(Array.isArray(c)&&c[1]){h=c[1]}});while(o<a&&s[o].slice(0,1)!=="{"){o++}while(i>0&&s[i].slice(-1)!=="}"){i--}s=s.slice(o,i+1);e=s.join("\r\n");if(h&&parseInt(h)>=400){n(t.HTTP_WRONG_RESPONSE_MSG+e);return}try{r(JSON.parse(e))}catch(r){n(t.HTTP_WRONG_RESPONSE_MSG+e)}};s.onerror=function(){n(this.responseText||t.HTTP_ERROR_MSG)};s.open("POST",e.serviceUrl+"$batch",true);s.setRequestHeader("Accept","multipart/mixed");s.setRequestHeader("Content-Type","multipart/mixed;boundary="+i);o.push("--"+i);o.push("Content-Type: application/http");o.push("Content-Transfer-Encoding: binary");o.push("");o.push("GET "+a+" HTTP/1.1");o.push("Accept:application/json");for(h in e.headers){c=e.headers[h];if(h.toLowerCase()!="accept"){s.setRequestHeader(h,c);o.push(h+":"+c)}}o.push("");o.push("");o.push("--"+i+"--");o.push("");o=o.join("\r\n");s.send(o);this.oPendingXHR=s}.bind(this))};t.prototype.sendGetRequest=function(e){return new Promise(function(r,n){var s;var i=new XMLHttpRequest;i.onload=function(){if(this.status>=400){n(this.responseText||this.statusText||t.HTTP_ERROR_MSG);return}try{r(JSON.parse(this.responseText))}catch(e){n(t.HTTP_WRONG_RESPONSE_MSG+this.responseText)}};i.onerror=function(){n(this.responseText||t.HTTP_ERROR_MSG)};i.open("GET",e.dataUrl,true);i.setRequestHeader("accept","application/json");for(s in e.headers){if(s.toLowerCase()!=="accept"){i.setRequestHeader(s,e.headers[s])}}i.send();this.oPendingXHR=i}.bind(this))};return t});
}
});
//# sourceMappingURL=library-preload.js.map
