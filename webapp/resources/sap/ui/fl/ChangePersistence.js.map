{"version":3,"file":"ChangePersistence.js","names":["sap","ui","define","union","includes","merge","UriParameters","Log","JsControlTreeModifier","Component","Applier","ChangesUtils","FlexObject","FlexObjectFactory","States","DependencyHandler","VariantManagementState","FlexState","StorageUtils","Settings","Condenser","Storage","Version","Cache","LayerUtils","Layer","Utils","JSONModel","Measurement","ChangePersistence","mComponent","this","_mComponent","_mChanges","createEmptyDependencyMap","_bChangesMapCreated","_mChangesInitial","name","error","Error","_aDirtyChanges","_oMessagebundle","undefined","_mChangesEntries","_bHasChangesOverMaxLayer","HIGHER_LAYER_CHANGES_EXIST","getChangeInstance","oFileContent","oChangeOrChangeContent","oChange","getId","fileName","createFromFileContent","setState","LifecycleState","PERSISTED","prototype","getComponentName","getCacheKey","oAppComponent","preconditionsFulfilled","sFileType","sVariantManagementReference","sVariantReference","sSelectorId","getFileType","getVariantReference","getSelector","id","oChangeContent","fileType","variantManagementReference","variantReference","selector","bControlVariantChange","getChangesForComponent","mPropertyBag","bInvalidateCache","getUShellService","then","oURLParsingService","_oUShellURLParsingService","getChangesFillingCache","bind","oWrappedChangeFileContent","oChangeFileContent","component","getAppComponentForControl","bHasFlexObjects","isStorageResponseFilled","changes","aChanges","messagebundle","getModel","some","layer","VENDOR","oModel","setModel","sCurrentLayer","currentLayer","bFilterMaxLayer","ignoreMaxLayerParameter","fnFilter","filterChangeOrChangeDefinitionsByCurrentLayer","isLayerFilteringRequired","filterChangeForMaxLayer","filter","bIncludeControlVariants","includeCtrlVariants","aFilteredVariantChanges","_getAllCtrlVariantChanges","concat","_checkAndGetChangeInstances","map","isOverMaxLayer","getLayerFromChangeOrChangeContent","sChangeLayer","isA","getLayer","bIncludeCtrlVariants","getInitialChanges","reference","reduce","aResult","sVariantChangeType","loadChangesMapForComponent","createChangeMap","start","forEach","addChangeAndUpdateDependencies","end","getChangesMapForComponent","getOpenDependentChangesForControl","oSelector","getControlIdBySelector","getInitalDependencyClone","mInitialDependencies","mDependencies","copyDependencies","oInitialDependency","aNewValidDependencies","sControlId","aNewValidControlDependencies","controlsDependencies","oDependentControlSelector","bySelector","push","mControlsWithDependencies","dependencies","length","copyDependenciesFromInitialChangesMapSync","fnDependencyValidation","call","sChangeId","mDependentChangesOnMe","copyDependenciesFromInitialChangesMap","oPreviousPromise","bDependencyIsStillValid","Promise","resolve","oReferenceChange","setInitialApplyState","insertChange","_addRunTimeCreatedChangeAndUpdateDependencies","addRuntimeChangeAndUpdateDependencies","getAllUIChanges","includeDirtyChanges","getDirtyChanges","Boolean","compareAgainstCurrentLayer","isChangeMapCreated","getChangesForView","filterChangeByView","addChange","vChange","addDirtyChange","_addPropagationListener","oNewChange","indexOf","oComponent","fnCheckIsNotFlPropagationListener","fnPropagationListener","_bIsSapUiFlFlexControllerApplyChangesOnControl","bNoFlPropagationListenerAttached","getPropagationListeners","every","oFlexControllerFactory","require","oFlexController","create","applyAllChangesForControl","addPropagationListener","_deleteNotSavedChanges","aCondensedChanges","bAlreadyDeletedViaCondense","oCondensedChange","removeChange","deleteChange","convertToFileContent","checkIfOnlyOne","sFunctionName","aProperties","aUniqueProperties","sValue","iIndex","canGivenChangesBeCondensed","bCondenseAnyLayer","bCondenserEnabled","sLayer","CUSTOMER","USER","oUriParameters","fromURL","window","location","href","has","get","isBackendCondensingEnabled","bEnabled","getInstanceOrUndef","isCondensingEnabled","updateCacheAndDeleteUnsavedChanges","aAllChanges","bSkipUpdateCache","_massUpdateCacheAndDirtyState","getAllRelevantChangesForCondensing","aDirtyChanges","aDraftFilenames","aPersistedAndSameLayerChanges","getState","canSingleRequestBeUsed","aRequests","getRequests","aStates","getStates","NEW","saveDirtyChanges","sParentVersion","aRelevantChangesForCondensing","bIsCondensingEnabled","aChangesClone","slice","oCondensedChangesPromise","condense","sRequest","allChanges","condensedChanges","transport","isLegacyVariant","parentVersion","oResponse","write","flexObjects","prepareDirtyChanges","saveSequenceOfDirtyChanges","oFirstNewChange","aNewChanges","shift","oDirtyChange","performSingleSaveAction","_updateCacheAndDirtyState","oFirstChange","Number","Draft","getRequest","DELETED","remove","flexObject","oExistingDirtyChange","isChangeRelatedToVariants","updateVariantsState","changeToBeAddedOrDeleted","DIRTY","updateChange","sState","bRunTimeCreatedChange","nIndexInDirtyChanges","splice","_deleteChangeInMap","markForDeletion","sChangeKey","removeChangeFromMap","removeChangeFromDependencies","isLocalAndInLayer","oObject","isPersistedAndInLayer","getAllCompVariantsEntities","aCompVariantEntities","mCompVariantsMap","getCompVariantsMap","sPersistencyKey","sId","byId","transportAllUIChanges","oRootControl","sStyleClass","aAppVariantDescriptors","aLocalChanges","publish","transportDialogSettings","rootControl","styleClass","localChanges","appVariantDescriptors","_getChangesFromMapByNames","aNames","removeDirtyChanges","vLayer","oControl","sGenerator","aChangeTypes","aLayers","aChangesToBeRemoved","bChangeValid","getSupportInformation","generator","vSelector","getChangeType","nIndex","resetChanges","aSelectorIds","bSelectorIdsProvided","bChangeTypesProvided","isPublicLayerAvailable","isApplicationReset","aCompVariantsEntries","mParams","selectorIds","changeTypes","reset","aChangesToRevert","response","oChangeContentId","removeChanges"],"sources":["ChangePersistence-dbg.js"],"mappings":";;;;;AAMAA,IAAIC,GAAGC,OAAO,CACb,kCACA,yBACA,sBACA,8BACA,eACA,oDACA,wBACA,4CACA,0CACA,mDACA,0DACA,+CACA,gEACA,6EACA,gDACA,2CACA,8BACA,gDACA,oCACA,8BACA,kBACA,uBACA,kBACA,kBACA,8BACA,kCACE,SACFC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,aAYA,IAAIC,EAAoB,SAASC,GAChCC,KAAKC,YAAcF,EAEnBC,KAAKE,UAAYlB,EAAkBmB,2BACnCH,KAAKI,oBAAsB,MAG3BJ,KAAKK,iBAAmB/B,EAAM,CAAC,EAAG0B,KAAKE,WAEvC,IAAKF,KAAKC,cAAgBD,KAAKC,YAAYK,KAAM,CAChD9B,EAAI+B,MAAM,gIACV,MAAM,IAAIC,MAAM,0BACjB,CAEAR,KAAKS,eAAiB,GACtBT,KAAKU,gBAAkBC,UACvBX,KAAKY,iBAAmB,CAAC,EACzBZ,KAAKa,yBAA2B,MAChCb,KAAKc,2BAA6B,4BACnC,EAEA,SAASC,EAAkBC,EAAcC,GACxC,IAAIC,EACJ,GAAID,aAAkCpC,EAAY,CACjDqC,EAAUD,EACVjB,KAAKY,iBAAiBM,EAAQC,SAAWD,CAC1C,KAAO,CACN,IAAKlB,KAAKY,iBAAiBK,EAAuBG,UAAW,CAC5DpB,KAAKY,iBAAiBK,EAAuBG,UAAYtC,EAAkBuC,sBAAsBJ,EAClG,CACAC,EAAUlB,KAAKY,iBAAiBK,EAAuBG,UACvDF,EAAQI,SAASvC,EAAOwC,eAAeC,UACxC,CACA,OAAON,CACR,CASApB,EAAkB2B,UAAUC,iBAAmB,WAC9C,OAAO1B,KAAKC,YAAYK,IACzB,EAUAR,EAAkB2B,UAAUE,YAAc,SAASC,GAClD,OAAOpC,EAAMmC,YAAY3B,KAAKC,YAAa2B,EAC5C,EAYA,SAASC,EAAuBZ,GAC/B,IAAIa,EACJ,IAAIC,EACJ,IAAIC,EACJ,IAAIC,EAEJ,GAAIhB,aAAkCpC,EAAY,CACjD,IAAIqC,EAAUD,EACda,EAAYZ,EAAQgB,cACpBF,EAAoBd,EAAQiB,sBAC5BF,EAAcf,EAAQkB,eAAiBlB,EAAQkB,cAAcC,EAC9D,KAAO,CACN,IAAIC,EAAiBrB,EACrBa,EAAYQ,EAAeC,SAC3BR,EAA8BO,EAAeE,2BAC7CR,EAAoBM,EAAeG,iBACnCR,EAAcK,EAAeI,UAAYJ,EAAeI,SAASL,EAClE,CAEA,IAAIM,EAAwB,MAC5B,GAAKb,IAAc,gBAAoBA,IAAc,uBAA2BA,IAAc,iCAAmC,CAChIa,EAAwBZ,GAA+BC,GAAqBC,CAC7E,CAEA,OAAOH,IAAc,UAAYa,CAClC,CAiBA7C,EAAkB2B,UAAUmB,uBAAyB,SAASC,EAAcC,GAC3E,OAAOnD,EAAMoD,iBAAiB,cAC5BC,KAAK,SAASC,GACdjD,KAAKkD,0BAA4BD,EACjC,OAAOzD,EAAM2D,uBAAuBnD,KAAKC,YAAa4C,EAAcC,EACrE,EAAEM,KAAKpD,OACNgD,KAAK,SAASH,EAAcQ,GAC5B,IAAIC,EAAqBhF,EAAM,CAAC,EAAG+E,GACnC,IAAIzB,EAAgBiB,GAAgBA,EAAaU,WAAa5D,EAAM6D,0BAA0BX,EAAaU,WAE3G,IAAIE,EAAkBtE,EAAauE,wBAAwBJ,EAAmBK,SAE9E,IAAKF,EAAiB,CACrB,MAAO,EACR,CAEA,IAAIG,EAAWN,EAAmBK,QAAQA,QAI1C,IAAK3D,KAAKU,iBAAmB4C,EAAmBO,eAAiBjC,EAAe,CAC/E,IAAKA,EAAckC,SAAS,kBAAmB,CAC9C,GAAIF,EAASG,KAAK,SAAS7C,GAC1B,OAAOA,EAAQ8C,QAAUtE,EAAMuE,MAChC,GAAI,CACHjE,KAAKU,gBAAkB4C,EAAmBO,cAC1C,IAAIK,EAAS,IAAItE,EAAUI,KAAKU,iBAChCkB,EAAcuC,SAASD,EAAQ,iBAChC,CACD,CACD,CAEA,IAAIE,EAAgBvB,GAAgBA,EAAawB,aACjD,IAAIC,IAAoBzB,GAAgBA,EAAa0B,yBACrD,IAAIC,EAAW,WAAa,OAAO,IAAM,EACzC,GAAIJ,EAAe,CAClBR,EAAWnE,EAAWgF,8CAA8Cb,EAAUQ,EAC/E,MAAO,GAAI3E,EAAWiF,yBAAyB1E,KAAKkD,4BAA8BoB,EAAiB,CAClGE,EAAWG,EAAwBvB,KAAKpD,MAExC4D,EAAWA,EAASgB,OAAOJ,EAC5B,MAAO,GAAIxE,KAAKa,2BAA6ByD,EAAiB,CAI7DtE,KAAKa,yBAA2B,MAChC,OAAOb,KAAKc,0BACb,CAEA,IAAI+D,EAA0BvB,EAAmBK,SAAWd,GAAgBA,EAAaiC,oBACzF,IAAIC,EAA0B/E,KAAKgF,0BAA0B1B,EAAoBuB,EAAyBL,GAC1GZ,EAAWA,EAASqB,OAAOF,GAE3B,OAAO/E,KAAKkF,4BAA4BtB,EAAUN,EACnD,EAAEF,KAAKpD,KAAM6C,GACf,EAEA/C,EAAkB2B,UAAUyD,4BAA8B,SAAStB,EAAUN,GAC5E,OAAOM,EACLgB,OAAO/C,GACPsD,IAAIpE,EAAkBqC,KAAKpD,KAAMsD,GACpC,EAEA,SAASqB,EAAwB1D,GAChC,GAAIxB,EAAW2F,eAAeC,EAAkCpE,GAAyBjB,KAAKkD,2BAA4B,CACzH,IAAKlD,KAAKa,yBAA0B,CACnCb,KAAKa,yBAA2B,IACjC,CACA,OAAO,KACR,CACA,OAAO,IACR,CAEA,SAASwE,EAAkCpE,GAC1C,IAAIqE,EACJ,UACQrE,EAAuBsE,MAAQ,aAClCtE,EAAuBsE,IAAI,oDAAsDtE,EAAuBsE,IAAI,mDAC/G,CACDD,EAAerE,EAAuBuE,UACvC,KAAO,CACNF,EAAerE,EAAuB+C,KACvC,CACA,OAAOsB,CACR,CAEAxF,EAAkB2B,UAAUuD,0BAA4B,SAAS1B,EAAoBmC,EAAsBjB,GAC1G,IAAKiB,EAAsB,CAC1B,OAAOxG,EAAuByG,kBAAkB,CAACC,UAAW3F,KAAKC,YAAYK,MAC9E,CACA,MAAO,CAAC,WAAY,iBAAkB,iCAAkC,4BACtEsF,OAAO,SAASC,EAASC,GACzB,GAAIxC,EAAmBK,QAAQmC,GAAqB,CACnD,OAAOD,EAAQZ,OAAO3B,EAAmBK,QAAQmC,GAClD,CACA,OAAOD,CACR,EAAG,IACFjB,OAAOJ,EACV,EASA1E,EAAkB2B,UAAUsE,2BAA6B,SAASnE,GACjE,OAAO5B,KAAK4C,uBAAuB,CAACW,UAAW3B,IAAgBoB,KAAKgD,EAAgB5C,KAAKpD,OAEzF,SAASgG,EAAgBpC,GACxB/D,EAAYoG,MAAM,yBAA0B,kDAE5CjG,KAAKE,UAAYlB,EAAkBmB,2BAEnCyD,EAASsC,QAAQlG,KAAKmG,+BAA+B/C,KAAKpD,KAAM4B,IAEhE5B,KAAKK,iBAAmB/B,EAAM,CAAC,EAAG0B,KAAKE,WAEvCL,EAAYuG,IAAI,yBAA0B,kDAC1CpG,KAAKI,oBAAsB,KAC3B,OAAOJ,KAAKqG,0BAA0BjD,KAAKpD,KAC5C,CACD,EAUAF,EAAkB2B,UAAU6E,kCAAoC,SAASC,EAAW3E,GACnF,OAAO5C,EAAkBsH,kCAAkCtG,KAAKE,UAAWzB,EAAsB+H,uBAAuBD,EAAW3E,GAAgBA,EACpJ,EAEA,SAAS6E,EAAyBvF,GACjC,IAAIwF,EAAuBpI,EAAM,CAAC,EAAG0B,KAAKK,iBAAiBsG,eAC3D,OAAOD,EAAqBxF,EAAQC,QACrC,CAEA,SAASyF,EAAiBC,EAAoBC,EAAuBlF,EAAeV,GACnF,IAAI6F,EACJ,IAAIC,EAA+B,GACnCH,EAAmBI,qBAAqBf,QAAQ,SAASgB,GAExD,IAAKzI,EAAsB0I,WAAWD,EAA2BtF,GAAgB,CAChFmF,EAAatI,EAAsB+H,uBAAuBU,EAA2BtF,GACrFoF,EAA6BI,KAAKF,GAClClH,KAAKE,UAAUmH,0BAA0BN,GAAc/G,KAAKE,UAAUmH,0BAA0BN,IAAe,GAC/G,IAAK1I,EAAS2B,KAAKE,UAAUmH,0BAA0BN,GAAa7F,EAAQC,SAAU,CACrFnB,KAAKE,UAAUmH,0BAA0BN,GAAYK,KAAKlG,EAAQC,QACnE,CACD,CACD,EAAEiC,KAAKpD,OAEP6G,EAAmBS,aAAeR,EAClCD,EAAmBI,qBAAuBD,EAC1C,GAAIF,EAAsBS,QAAUP,EAA6BO,OAAQ,CACxEvH,KAAKE,UAAUyG,cAAczF,EAAQC,SAAW0F,CACjD,CACD,CAYA/G,EAAkB2B,UAAU+F,0CAA4C,SAAStG,EAASuG,EAAwB7F,GACjH,IAAIiF,EAAqBJ,EAAyBiB,KAAK1H,KAAMkB,GAC7D,GAAI2F,EAAoB,CACvB,IAAIC,EAAwB,GAC5BD,EAAmBS,aAAapB,QAAQ,SAASyB,GAChD,GAAIF,EAAuBE,GAAY,CACtC3H,KAAKE,UAAU0H,sBAAsBD,GAAa3H,KAAKE,UAAU0H,sBAAsBD,IAAc,GACrG3H,KAAKE,UAAU0H,sBAAsBD,GAAWP,KAAKlG,EAAQC,SAC7D2F,EAAsBM,KAAKO,EAC5B,CACD,EAAEvE,KAAKpD,OACP4G,EAAiBc,KAAK1H,KAAM6G,EAAoBC,EAAuBlF,EAAeV,EACvF,CACA,OAAOlB,KAAKE,SACb,EAYAJ,EAAkB2B,UAAUoG,sCAAwC,SAAS3G,EAASuG,EAAwB7F,GAC7G,IAAIiF,EAAqBJ,EAAyBiB,KAAK1H,KAAMkB,GAC7D,GAAI2F,EAAoB,CACvB,IAAIC,EAAwB,GAC5B,OAAOD,EAAmBS,aAAa1B,OAAO,SAAUkC,EAAkBH,GACzE,OAAOG,EAAiB9E,KAAK,WAC5B,OAAOyE,EAAuBE,EAC/B,GAAG3E,KAAK,SAAU+E,GACjB,GAAIA,EAAyB,CAC5B/H,KAAKE,UAAU0H,sBAAsBD,GAAa3H,KAAKE,UAAU0H,sBAAsBD,IAAc,GACrG3H,KAAKE,UAAU0H,sBAAsBD,GAAWP,KAAKlG,EAAQC,SAC7D2F,EAAsBM,KAAKO,EAC5B,CACD,EAAEvE,KAAKpD,MACR,EAAEoD,KAAKpD,MAAOgI,QAAQC,WACrBjF,KAAK,WACL4D,EAAiBc,KAAK1H,KAAM6G,EAAoBC,EAAuBlF,EAAeV,GACtF,OAAOlB,KAAKE,SACb,EAAEkD,KAAKpD,MACR,CACA,OAAOgI,QAAQC,QAAQjI,KAAKE,UAC7B,EASAJ,EAAkB2B,UAAU0E,+BAAiC,SAASvE,EAAeV,EAASgH,GAG7FhH,EAAQiH,uBACR,GAAID,EAAkB,CACrBlJ,EAAkBoJ,aAAalH,EAASlB,KAAKE,UAAWgI,EACzD,CACAlJ,EAAkBmH,+BAA+BjF,EAASU,EAAe5B,KAAKE,UAC/E,EAEAJ,EAAkB2B,UAAU4G,8CAAgD,SAASzG,EAAeV,GACnGlC,EAAkBsJ,sCAAsCpH,EAASU,EAAe5B,KAAKE,UAAWF,KAAKK,iBACtG,EAOAP,EAAkB2B,UAAU4E,0BAA4B,WACvD,OAAOrG,KAAKE,SACb,EAUAJ,EAAkB2B,UAAU8G,gBAAkB,SAAS1F,GACtD,IAAIe,EAAWxF,EACd4B,KAAKqG,4BAA4BzC,SACjCf,EAAa2F,qBAAuBxI,KAAKyI,mBACxC7D,OAAO,SAAU1D,GAClB,OACCwH,QAAQxH,IACLA,EAAQgB,gBAAkB,UAC1BzC,EAAWkJ,2BAA2BzH,EAAQsE,WAAY3C,EAAamB,SAAW,CAEvF,GACA,OAAOJ,CACR,EAOA9D,EAAkB2B,UAAUmH,mBAAqB,WAChD,OAAO5I,KAAKI,mBACb,EAyBAN,EAAkB2B,UAAUoH,kBAAoB,SAAShG,GACxD,OAAO7C,KAAK4C,uBAAuBC,GAAcG,KAAK,SAASY,GAC9D,OAAOA,EAASgB,OAAOhG,EAAakK,mBAAmB1F,KAAKzC,UAAWkC,GACxE,EACD,EAUA/C,EAAkB2B,UAAUsH,UAAY,SAASC,EAASpH,GACzD,IAAIV,EAAUlB,KAAKiJ,eAAeD,GAClChJ,KAAKqI,8CAA8CzG,EAAeV,GAClElB,KAAKY,iBAAiBM,EAAQC,SAAWD,EACzClB,KAAKkJ,wBAAwBtH,GAC7B,OAAOV,CACR,EASApB,EAAkB2B,UAAUwH,eAAiB,SAASD,GACrD,IAAIG,EACJ,UAAWH,EAAQzD,MAAQ,YAAcyD,EAAQzD,IAAI,oDAAqD,CACzG4D,EAAaH,CACd,KAAO,CACNG,EAAarK,EAAkBuC,sBAAsB2H,EACtD,CAGA,GAAIhJ,KAAKS,eAAe2I,QAAQD,MAAiB,EAAG,CACnDnJ,KAAKS,eAAe2G,KAAK+B,EAC1B,CACA,OAAOA,CACR,EASArJ,EAAkB2B,UAAUyH,wBAA0B,SAASG,GAC9D,IAAIzH,EAAgBjC,EAAM6D,0BAA0B6F,GACpD,GAAIzH,aAAyBlD,EAAW,CACvC,IAAI4K,EAAoC,SAASC,GAChD,OAAQA,EAAsBC,8CAC/B,EAEA,IAAIC,EAAmC7H,EAAc8H,0BAA0BC,MAAML,GAErF,GAAIG,EAAkC,CACrC,IAAIG,EAAyB3L,IAAIC,GAAG2L,QAAQ,mCAC5C,IAAIC,EAAkBF,EAAuBG,OAAO/J,KAAK0B,oBACzD,IAAI6H,EAAwB5K,EAAQqL,0BAA0B5G,KAAKzE,EAASqB,KAAKqG,0BAA0BjD,KAAKpD,MAAO4B,EAAekI,GACtIP,EAAsBC,+CAAiD,KACvE5H,EAAcqI,uBAAuBV,EACtC,CACD,CACD,EAEAzJ,EAAkB2B,UAAUyI,uBAAyB,SAAStG,EAAUuG,EAAmBC,GAC1FxG,EAASgB,OAAO,SAAS1D,GACxB,OAAQiJ,EAAkBpG,KAAK,SAASsG,GACvC,OAAOnJ,EAAQC,UAAYkJ,EAAiBlJ,OAC7C,EACD,GAAG+E,QAAQ,SAAShF,GACnB,GAAIkJ,EAA4B,CAC/BpK,KAAKsK,aAAapJ,GAElB1B,EAAM+K,aAAavK,KAAKC,YAAaiB,EAAQsJ,uBAC9C,KAAO,CACNxK,KAAKuK,aAAarJ,EACnB,CACD,EAAEkC,KAAKpD,MACR,EAEA,SAASyK,EAAe7G,EAAU8G,GACjC,IAAIC,EAAc/G,EAASuB,IAAI,SAASjE,GACvC,OAAOA,EAAQwJ,IAChB,GACA,IAAIE,EAAoBD,EAAY/F,OAAO,SAASiG,EAAQC,EAAQH,GACnE,OAAOA,EAAYvB,QAAQyB,KAAYC,CACxC,GAEA,OAAOF,EAAkBrD,SAAW,CACrC,CAEA,SAASwD,EAA2BnJ,EAAegC,EAAUoH,GAC5D,IAAIC,EAAoB,MAExB,IAAKrJ,GAAiBgC,EAAS2D,OAAS,IAAMkD,EAAe7G,EAAU,YAAa,CACnF,OAAO,KACR,CAEA,GAAIoH,EAAmB,CACtBC,EAAoB,IACrB,KAAO,CACN,IAAIC,EAAStH,EAAS,GAAG4B,WACzB,GAAI,CAAC9F,EAAMyL,SAAUzL,EAAM0L,MAAM/M,SAAS6M,GAAS,CAClDD,EAAoB,IACrB,CACD,CAEA,IAAII,EAAiB9M,EAAc+M,QAAQC,OAAOC,SAASC,MAC3D,GAAIJ,EAAeK,IAAI,8BAA+B,CACrDT,EAAoBI,EAAeM,IAAI,gCAAkC,MAC1E,CAEA,OAAOV,CACR,CAEA,SAASW,EAA2BhI,GACnC,IAAIiI,EAAWzM,EAAS0M,sBAAwB1M,EAAS0M,qBAAqBC,sBAC9E,GAAIF,IAAapB,EAAe7G,EAAU,gBAAiB,CAC1DiI,EAAW,KACZ,CAEA,OAAOA,CACR,CAEA,SAASG,EAAmCC,EAAa9B,EAAmB+B,EAAkB9B,GAC7FpK,KAAKmM,8BAA8BhC,EAAmB+B,GACtDlM,KAAKkK,uBAAuB+B,EAAa9B,EAAmBC,EAC7D,CAEA,SAASgC,EAAmCC,EAAeC,EAAiBtB,EAAmBE,GAC9F,IAAKmB,EAAc9E,SAAWyD,EAAmB,CAChD,MAAO,EACR,CACA,IAAIuB,EAAgCvM,KAAKE,UAAU0D,SAASgB,OAAO,SAAS1D,GAC3E,GAAIgK,IAAWxL,EAAMyL,UAAYmB,EAAiB,CACjD,OAAOpL,EAAQsL,aAAezN,EAAOwC,eAAeC,WAAa8K,EAAgBjO,SAAS6C,EAAQC,QACnG,CACA,OAAOD,EAAQsL,aAAezN,EAAOwC,eAAeC,WAAa/B,EAAWkJ,2BAA2BzH,EAAQsE,WAAY0F,KAAY,CACxI,GACA,OAAOqB,EAA8BtH,OAAOoH,EAC7C,CAEA,SAASI,EAAuBJ,GAC/B,GAAIA,EAAc9E,OAAQ,CACzB,IAAImF,EAAYC,EAAYN,GAC5B,IAAIO,EAAUC,EAAUR,GACxB,OAAOO,EAAQrF,SAAW,GAAKmF,EAAUnF,SAAW,GAAKqF,EAAQ,KAAO7N,EAAOwC,eAAeuL,GAC/F,CACA,OAAO,IACR,CAmBAhN,EAAkB2B,UAAUsL,iBAAmB,SAASnL,EAAesK,EAAkBtI,EAAUoJ,EAAgBV,EAAiBtB,EAAmBE,GACtJ,IAAImB,EAAgBzI,GAAY5D,KAAKS,eACrC,IAAI2D,EAAgBiI,EAAc9E,QAAU8E,EAAc,GAAG7G,YAAc0F,EAC3E,IAAI+B,EAAgCb,EAAmC1E,KAAK1H,KAAMqM,EAAeC,EAAiBtB,EAAmB5G,GACrI,IAAI8I,EACHtB,EAA2BqB,IACxBlC,EAA2BnJ,EAAeqL,EAA+BjC,GAE7E,IAAIiB,EAAciB,EAAuBD,EAAgCZ,EACzE,IAAIc,EAAgBlB,EAAYmB,MAAM,GACtC,IAAIV,EAAYC,EAAYN,GAE5B,GAAII,EAAuBJ,GAAgB,CAC1C,IAAIgB,EAA2BrF,QAAQC,QAAQkF,GAC/C,GAAIpC,EAA2BnJ,EAAeuL,EAAenC,GAAoB,CAChFqC,EAA2BhO,EAAUiO,SAAS1L,EAAeuL,EAC9D,CACA,OAAOE,EAAyBrK,KAAK,SAASmH,GAC7C,IAAIoD,EAAWb,EAAU,GACzB,GAAIQ,EAAsB,CACzB,OAAO5N,EAAQgO,SAAS,CACvBE,WAAYvB,EACZwB,iBAAkBtD,EAClBnG,MAAOI,EACPsJ,UAAWH,EACXI,gBAAiB,MACjBC,cAAeZ,IACbhK,KAAK,SAAS6K,GAChB7B,EAAmCtE,KAAK1H,KAAMiM,EAAa9B,EAAmB+B,EAAkB,MAChG,OAAO2B,CACR,EAAEzK,KAAKpD,MACR,CACA,GAAImK,EAAkB5C,OAAQ,CAC7B,OAAOjI,EAAQwO,MAAM,CACpB9J,MAAOI,EACP2J,YAAaC,EAAoB7D,GACjCuD,UAAWH,EACXI,gBAAiB,MACjBC,cAAeZ,IACbhK,KAAK,SAAS6K,GAChB7B,EAAmCtE,KAAK1H,KAAMiM,EAAa9B,EAAmB+B,GAC9E,OAAO2B,CACR,EAAEzK,KAAKpD,MACR,CACAA,KAAKkK,uBAAuB+B,EAAa9B,EAC1C,EAAE/G,KAAKpD,MACR,CAEA,OAAOA,KAAKiO,2BAA2B5B,EAAeH,EAAkBc,EACzE,EAaAlN,EAAkB2B,UAAUwM,2BAA6B,SAAS5B,EAAeH,EAAkBc,GAClG,IAAIkB,EACJ,GAAIlB,EAAgB,CAGnB,IAAImB,EAAc9B,EAAczH,OAAO,SAAU1D,GAChD,OAAOA,EAAQsL,aAAezN,EAAOwC,eAAeuL,GACrD,GACAoB,EAAkB,GAAGjJ,OAAOkJ,GAAaC,OAC1C,CAEA,OAAO/B,EAAczG,OAAO,SAASkC,EAAkBuG,GACtD,OAAOvG,EACL9E,KAAKsL,EAAwBlL,KAAKzC,UAAW0N,EAAcH,EAAiBlB,IAC5EhK,KAAKhD,KAAKuO,0BAA0BnL,KAAKpD,KAAMqO,EAAcnC,GAChE,EAAE9I,KAAKpD,MAAOgI,QAAQC,UACvB,EAEA,SAASqG,EAAwBD,EAAcG,EAAcxB,GAC5D,OAAQqB,EAAa7B,YACpB,KAAKzN,EAAOwC,eAAeuL,IAC1B,GAAIE,IAAmBrM,UAAW,CACjCqM,EAAiBqB,IAAiBG,EAAexB,EAAiBzN,EAAQkP,OAAOC,KAClF,CACA,OAAOpP,EAAQwO,MAAM,CACpB9J,MAAOqK,EAAa7I,WACpBuI,YAAa,CAACM,EAAa7D,wBAC3BkD,UAAWW,EAAaM,aACxBf,cAAeZ,IAEjB,KAAKjO,EAAOwC,eAAeqN,QAC1B,OAAOtP,EAAQuP,OAAO,CACrBC,WAAYT,EAAa7D,uBACzBxG,MAAOqK,EAAa7I,WACpBkI,UAAWW,EAAaM,aACxBf,cAAeZ,IAEjB,SAEF,CAQAlN,EAAkB2B,UAAU8M,0BAA4B,SAASF,EAAcnC,GAC9ElM,KAAKS,eAAiBT,KAAKS,eAAemE,OAAO,SAASmK,GACzD,OAAOV,EAAalN,UAAY4N,EAAqB5N,OACtD,GAEA,IAAK+K,EAAkB,CACtB,GAAIvM,EAAMqP,0BAA0BX,GAAe,CAClDpP,EAAuBgQ,oBAAoB,CAC1CtJ,UAAW3F,KAAKC,YAAYK,KAC5B4O,yBAA0Bb,GAE5B,KAAO,CACN,OAAQA,EAAa7B,YACpB,KAAKzN,EAAOwC,eAAeuL,IAC1BuB,EAAa/M,SAASvC,EAAOwC,eAAeC,WAC5ChC,EAAMuJ,UAAU/I,KAAKC,YAAaoO,EAAa7D,wBAC/C,MACD,KAAKzL,EAAOwC,eAAeqN,QAC1BpP,EAAM+K,aAAavK,KAAKC,YAAaoO,EAAa7D,wBAClD,MACD,KAAKzL,EAAOwC,eAAe4N,MAC1Bd,EAAa/M,SAASvC,EAAOwC,eAAeC,WAC5ChC,EAAM4P,aAAapP,KAAKC,YAAaoO,EAAa7D,wBAClD,MAEH,CACD,CACD,EAOA1K,EAAkB2B,UAAU0K,8BAAgC,SAASE,EAAeH,GACnFG,EAAcnG,QAAQ,SAASmI,GAC9BrO,KAAKuO,0BAA0BF,EAAcnC,EAC9C,EAAGlM,KACJ,EAEA,SAAS2M,EAAYN,GACpB,IAAIK,EAAY,GAEhBL,EAAcnG,QAAQ,SAAShF,GAC9B,IAAIqM,EAAWrM,EAAQyN,aACvB,GAAIjC,EAAUtD,QAAQmE,MAAe,EAAG,CACvCb,EAAUtF,KAAKmG,EAChB,CACD,GAEA,OAAOb,CACR,CAEA,SAASG,EAAUR,GAClB,IAAIO,EAAU,GAEdP,EAAcnG,QAAQ,SAAShF,GAC9B,IAAImO,EAASnO,EAAQsL,WACrB,GAAII,EAAQxD,QAAQiG,MAAa,EAAG,CACnCzC,EAAQxF,KAAKiI,EACd,CACD,GAEA,OAAOzC,CACR,CAEA,SAASoB,EAAoB3B,GAC5B,IAAIzI,EAAW,GAEfyI,EAAcnG,QAAQ,SAAShF,GAC9B0C,EAASwD,KAAKlG,EAAQsJ,uBACvB,GAEA,OAAO5G,CACR,CAEA9D,EAAkB2B,UAAUgH,gBAAkB,WAC7C,OAAOzI,KAAKS,cACb,EAeAX,EAAkB2B,UAAU8I,aAAe,SAASrJ,EAASoO,GAC5D,IAAIC,EAAuBvP,KAAKS,eAAe2I,QAAQlI,GAEvD,GAAIqO,GAAwB,EAAG,CAC9B,GAAIrO,EAAQsL,aAAezN,EAAOwC,eAAeqN,QAAS,CACzD,MACD,CACA5O,KAAKS,eAAe+O,OAAOD,EAAsB,GACjDvP,KAAKyP,mBAAmBvO,EAASoO,GACjC,MACD,CAEApO,EAAQwO,kBACR1P,KAAKiJ,eAAe/H,GACpBlB,KAAKyP,mBAAmBvO,EAASoO,EAClC,EAEAxP,EAAkB2B,UAAU6I,aAAe,SAASpJ,GACnD,IAAIqO,EAAuBvP,KAAKS,eAAe2I,QAAQlI,GAEvD,GAAIqO,GAAwB,EAAG,CAC9BvP,KAAKS,eAAe+O,OAAOD,EAAsB,EAClD,CACAvP,KAAKyP,mBAAmBvO,EACzB,EASApB,EAAkB2B,UAAUgO,mBAAqB,SAASvO,EAASoO,GAClE,IAAIK,EAAazO,EAAQC,QACzBnC,EAAkB4Q,oBAAoB5P,KAAKE,UAAWyP,GACtD3Q,EAAkB6Q,6BAA6BP,EAAwBtP,KAAKK,iBAAmBL,KAAKE,UAAWyP,EAChH,EAEA,SAASG,EAAkB5E,EAAQ6E,GAClC,OAAQA,EAAQpB,eAAiB,QAAUoB,EAAQpB,eAAiB,KAAOoB,EAAQvK,aAAe0F,CACnG,CAEA,SAAS8E,EAAsB9E,EAAQ6E,GACtC,OAAOA,EAAQvD,aAAezN,EAAOwC,eAAeC,WAAauO,EAAQvK,aAAe0F,CACzF,CAEA,SAAS+E,IACR,IAAIC,EAAuB,GAC3B,IAAIC,EAAmBjR,EAAUkR,mBAAmBpQ,KAAK0B,oBACzD,IAAK,IAAI2O,KAAmBF,EAAkB,CAC7C,IAAK,IAAIG,KAAOH,EAAiBE,GAAiBE,KAAM,CACvDL,EAAqB9I,KAAK+I,EAAiBE,GAAiBE,KAAKD,GAClE,CACD,CACA,OAAOJ,CACR,CAUApQ,EAAkB2B,UAAU+O,sBAAwB,SAASC,EAAcC,EAAaxF,EAAQyF,GAC/F,OAAO3Q,KAAK4C,uBAAuB,CAACyB,aAAc6G,EAAQpG,oBAAqB,OAAO9B,KAAK,SAAS4N,GACnG,IAAIV,EAAuBD,EAA2BvI,KAAK1H,MAE3D4Q,EAAgBA,EAAc3L,OAC7BiL,EAAqBtL,OAAOkL,EAAkB1M,KAAKpD,KAAMkL,KAE1D,OAAO5L,EAAQuR,QAAQ,CACtBC,wBAAyB,CACxBC,YAAaN,EACbO,WAAYN,GAEb1M,MAAOkH,EACPvF,UAAW3F,KAAK0B,mBAChBuP,aAAcL,EACdM,sBAAuBP,GAEzB,EAAEvN,KAAKpD,MACR,EASAF,EAAkB2B,UAAU0P,0BAA4B,SAASC,GAChE,OAAOpR,KAAKE,UAAU0D,SAASgB,OAAO,SAAS1D,GAC9C,OAAOkQ,EAAOhI,QAAQlI,EAAQC,YAAc,CAC7C,EACD,EAaArB,EAAkB2B,UAAU4P,mBAAqB,SAASC,EAAQjI,EAAYkI,EAAUC,EAAYC,GACnG,IAAIC,EAAU,GAAGzM,OAAOqM,GAAU,IAClC,IAAIjF,EAAgBrM,KAAKS,eAEzB,IAAIkR,EAAsBtF,EAAczH,OAAO,SAAU1D,GACxD,IAAI0Q,EAAe,KAEnB,GAAIF,EAAQnK,SAAWmK,EAAQrT,SAAS6C,EAAQsE,YAAa,CAC5D,OAAO,KACR,CAEA,GAAIgM,GAActQ,EAAQ2Q,wBAAwBC,YAAcN,EAAY,CAC3E,OAAO,KACR,CAEA,GAAID,EAAU,CACb,IAAIQ,EAAY7Q,EAAQkB,cACxBwP,EAAeL,EAASpQ,UAAY1C,EAAsB+H,uBAAuBuL,EAAW1I,EAC7F,CAEA,GAAIoI,EAAc,CACjBG,EAAeA,GAAgBH,EAAarI,QAAQlI,EAAQ8Q,oBAAsB,CACnF,CAEA,OAAOJ,CACR,GAEAD,EAAoBzL,QAAQ,SAAUhF,GACrC,IAAI+Q,EAAS5F,EAAcjD,QAAQlI,GACnCmL,EAAcmD,OAAOyC,EAAQ,EAC9B,GAEA,OAAOjK,QAAQC,QAAQ0J,EACxB,EAeA7R,EAAkB2B,UAAUyQ,aAAe,SAAShH,EAAQsG,EAAYW,EAAcV,GACrF,IAAIW,EAAuBD,GAAgBA,EAAa5K,OAAS,EACjE,IAAI8K,EAAuBZ,GAAgBA,EAAalK,OAAS,EAGjE,IAAI+K,EAAyBlT,EAAS0M,sBAAwB1M,EAAS0M,qBAAqBwG,yBAC5F,IAAIC,EAAqBf,IAAe7Q,WAAawR,IAAiBxR,WAAa8Q,IAAiB9Q,UACpG,IAAI6R,EAAuB,GAC3B,GAAIF,GAA0BC,EAAoB,CACjDC,EAAuBvC,EAA2BvI,KAAK1H,MAAM4E,OAAOoL,EAAsB5M,KAAKpD,KAAMkL,GACtG,CAEA,OAAOlL,KAAK4C,uBAAuB,CAAEyB,aAAc6G,EAAQpG,oBAAqB,OAAO9B,KAAK,SAASY,GACpGA,EAAWA,EAASqB,OAAOuN,GAC3B,IAAIC,EAAU,CACb9M,UAAW3F,KAAK0B,mBAChBsC,MAAOkH,EACPvH,QAASC,GAEV,GAAI4N,EAAY,CACfiB,EAAQX,UAAYN,CACrB,CACA,GAAIY,EAAsB,CACzBK,EAAQC,YAAcP,CACvB,CACA,GAAIE,EAAsB,CACzBI,EAAQE,YAAclB,CACvB,CAEA,OAAOnS,EAAQsT,MAAMH,EACtB,EAAErP,KAAKpD,OACNgD,KAAK,SAAS6K,GACd,IAAIgF,EAAmB,GAEvB,GAAIV,GAAgBV,EAAc,CACjC,IAAIL,EAAS,GACb,GAAIvD,GAAaA,EAAUiF,UAAYjF,EAAUiF,SAASvL,OAAS,EAAG,CACrEsG,EAAUiF,SAAS5M,QAAQ,SAAU6M,GACpC3B,EAAOhK,KAAK2L,EAAiB3R,SAC9B,EACD,CACA5B,EAAMwT,cAAchT,KAAKC,YAAamR,GACtCyB,EAAmB7S,KAAKmR,0BAA0BC,EACnD,CACA,OAAOyB,CACR,EAAEzP,KAAKpD,MACR,EAEA,OAAOF,CACR"}